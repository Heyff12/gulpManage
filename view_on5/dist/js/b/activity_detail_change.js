"use strict";require(["../require-config2"],function(){require(["zepto"],function($){$(function(){function e(e,t){var a={pos:t,count:20};0!=u.activity_id&&(a.activity_id=u.activity_id),a.biz_type_l=u.biz_type_l,$.ajax({type:"GET",url:e,data:a,dataType:"json",beforeSend:function(){$("#load_small_bg").show()},context:$("body"),success:function(e){"0000"!==e.respcd?($("#alert_alert").show(),$(".zheceng1").show(),e.respmsg?$("#alert_alert .alert_con_br").html(e.respmsg):$("#alert_alert .alert_con_br").html(e.resperr)):n(e.data)},error:function(e,t){$("#alert_alert").show(),$(".zheceng1").show(),$("#alert_alert .alert_con_br").html("网络超时!")},complete:function(){i(),u.loading=!1,$("#load_small_bg").hide()}})}function t(){var e={};0!=u.activity_id&&(e.activity_id=u.activity_id),$.ajax({type:"GET",url:"/prepaid/v1/api/stat/recharge",data:e,dataType:"json",context:$("body"),beforeSend:function(){$("#load_small_bg").show()},success:function(e){"0000"!==e.respcd?($("#alert_alert").show(),$(".zheceng").show(),e.respmsg?$("#alert_alert .alert_con_br").html(e.respmsg):$("#alert_alert .alert_con_br").html(e.resperr)):(document.getElementsByClassName("js-storedValue")[0].innerText=parseInt(e.data.pay_amt/100)+"",document.getElementsByClassName("js-presentValue")[0].innerText="￥"+parseInt(e.data.present_amt/100))},error:function(e,t){$("#alert_alert").show(),$(".zheceng").show(),$("#alert_alert .alert_con_br").html("网络超时!")},complete:function(){$("#load_small_bg").hide()}})}function n(e){i();for(var t=0;t<e.length;t++){var n=e[t];if(u.currentSNs.indexOf(n.biz_sn)===-1){u.currentSNs.push(n.biz_sn);var r,o=n.c_avatar,l=n.sysdtm;if(1===u.biz_type_l){var c=parseInt(n.pay_amt/100),s=parseInt(n.present_amt/100);r=a(!1,o,"储值",c,s,l);var d=a(!0,o,"储值赠送",c,s,l);document.getElementById("content").appendChild(d)}else r=a(!1,o,"储值消费",n.txamt/100,0,l);document.getElementById("content").appendChild(r)}}u.canLoadMoer=e.length>=20}function a(e,t,n,a,r,o){var l=document.createElement("div");l.className="detail-list";var i=document.createElement("div");i.className="list-content",l.appendChild(i);var c=document.createElement("img");c.src=t;var s=document.createElement("span");s.className="js-name",s.innerText=n;var d=document.createElement("span");if(e){var m=document.createElement("span");m.className="js-storedTag box-orange",m.innerText="储值"+a+"送"+r,s.appendChild(m),d.innerText=r}else d.innerText=a;var u=document.createElement("span");u.className="js-date",u.innerText=o;var p=document.createElement("span");p.className="amount",p.innerText="￥",p.appendChild(d),i.appendChild(c),i.appendChild(s),i.appendChild(u),i.appendChild(p);var h=document.createElement("div");return h.className="footer-line",l.appendChild(h),l}function r(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substr(1).match(t);return null!=n?unescape(n[2]):0}function o(){var e=window.location.href.split("/");return"consume.html"===e[e.length-1]?2:1}function l(){var e=document.getElementsByClassName("load")[0];e.style.display="block"}function i(){var e=document.getElementsByClassName("load")[0];e.style.display="none"}function c(){return document.getElementsByClassName("footer-line")}function s(){for(var e=c(),t=0;t<e.length;t++)if(t==e.length-1)return e[t].offsetTop}function d(){$("#nomoredata").animate({opacity:0},500,"ease-out")}var m=function(e,t){this.lastScrollY=e,this.canLoadMoer=t,this.currentSNs=[],this.activity_id=r("activity_id"),this.biz_type_l=o(),this.loading=!1,this.canScroll=!0},u=new m(0,(!1));window.onscroll=function(t){if(u.canScroll){var n=document.documentElement.scrollTop||document.body.scrollTop,a=s(),r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,o=n+r;o>a&&n>u.lastScrollY&&u.canLoadMoer&&!u.loading?(u.canLoadMoer=!1,u.loading=!0,l(),window.setTimeout(function(){e("/prepaid/v1/api/transactions",u.currentSNs.length)},3e3)):o>a&&n>u.lastScrollY&&!u.canLoadMoer&&!u.loading&&($(".load").hide(),$("#nomoredata").animate({opacity:.7},500,"ease-out"),window.setTimeout(d,2e3),u.canScroll=!1),u.lastScrollY=n}},1===u.biz_type_l&&t(),e("/prepaid/v1/api/transactions",u.currentSNs.length),$(".js_alert_con_close").on("click",function(){$(".alert_con").hide(),$(".zheceng").hide(),$(".zheceng1").hide(),$(".zheceng2").hide()})})})});
//# sourceMappingURL=../../maps/js/b/activity_detail_change.js.map
