"use strict";require(["../require-config2"],function(){require(["zepto","yanzheng","close_tip","if_menu"],function($,e,a,s){$(function(){function l(){var a=e.get_hash("c");$.ajax({url:"/prepaid/v1/api/b/member/"+a,type:"GET",dataType:"json",data:{},beforeSend:function(){$("#load_small_bg").show()},success:function(e){if("0000"!=e.respcd)$("#alert_alert").show(),$(".zheceng1").show(),e.respmsg?$("#alert_alert .alert_con_br").html(e.respmsg):$("#alert_alert .alert_con_br").html(e.resperr);else{var a=e.data,s=a.avatar,l=a.mobile,t=a.name,i=a.recharge_times,r=(a.recharge_amt/100).toFixed(0),o=(a.balance/100).toFixed(2);$(".js_m_img").attr("src",s),$(".js_m_tel").text(l),$(".js_m_name").text(t),$(".js_m_times").text(i),$(".js_m_all").text(r),$(".js_m_loft").text(o)}},error:function(e){$("#alert_alert").show(),$(".zheceng1").show(),$("#alert_alert .alert_con_br").html("网络超时!")},complete:function(){$("#load_small_bg").hide()}})}function t(){$.ajax({url:"/prepaid/v1/api/transactions",type:"GET",dataType:"json",data:{c:e.get_hash("c"),pos:$("#js_pos").val(),count:20},beforeSend:function(){$("#load_small_bg").show()},success:function(e){if("0000"!=e.respcd)$("#alert_alert").show(),$(".zheceng").show(),e.respmsg?$("#alert_alert .alert_con_br").html(e.respmsg):$("#alert_alert .alert_con_br").html(e.resperr);else{var a=e.data,s=0;!a||a.length<1?$(".js_empty").show():$(".js_empty").hide(),$(a).each(function(e,l){for(var t,i=r.length,o=(a[e].txamt/100).toFixed(2),d=(a[e].pay_amt/100).toFixed(2),n=(a[e].present_amt/100).toFixed(2),c=((a[e].pay_amt/100).toFixed(0),(a[e].present_amt/100).toFixed(0)),_=a[e].sysdtm,m=a[e].status,p=a[e].biz_type,h=a[e].biz_sn,u="0",e=i-1;e>0;e--)if(r[e]==h){u="1";break}return"1"==u||(r.push(h),s++,t="1"==p?'<li><dl><dd>储值</dd><dd class="grey">'+_+'</dd><div class="clearfix"></div></dl><span class="history_num zeng orange">+<i class="i_normal">'+d+'</i><br/><i class="i_normal grey">赠送￥'+n+'</i></span><div class="clearfix"></div></li>':"2"==p?"4"==m?'<li class="grey"><dl><dd>储值消费(已撤销)</dd><dd class="grey">'+_+'</dd><div class="clearfix"></div></dl><span class="history_num">-<i class="i_normal">'+o+'</i></span><div class="clearfix"></div></li>':'<li><dl><dd>储值消费</dd><dd class="grey">'+_+'</dd><div class="clearfix"></div></dl><span class="history_num">-<i class="i_normal">'+o+'</i></span><div class="clearfix"></div></li>':"4"==p?c>0?'<li><dl><dd>手动储值</dd><dd class="grey">'+_+'</dd><div class="clearfix"></div></dl><span class="history_num zeng orange">+<i class="i_normal">'+d+'</i><br/><i class="i_normal grey">赠送￥'+n+'</i></span><div class="clearfix"></div></li>':'<li><dl><dd>手动储值</dd><dd class="grey">'+_+'</dd><div class="clearfix"></div></dl><span class="history_num orange">+<i class="i_normal">'+o+'</i></span><div class="clearfix"></div></li>':'<li><dl><dd>消费退款</dd><dd class="grey">'+_+'</dd><div class="clearfix"></div></dl><span class="history_num">+<i class="i_normal">'+o+'</i></span><div class="clearfix"></div></li>',void $(".js_ul_history").append(t))});var l=$("#js_pos").val()-0;a.length<20?(s>0?n=!0:($("#nomoredata").animate({opacity:.7},500,"ease-out"),window.setTimeout(i,3e3),n=!1),d=!1):(l+=20,$("#js_pos").val(l),d=!0),$(".zheceng").hide(),$(".load").hide(),_=Math.floor($("body").height()).toFixed(0)}},error:function(e){$("#alert_alert").show(),$(".zheceng").show(),$("#alert_alert .alert_con_br").html("网络超时!")},complete:function(){$("#load_small_bg").hide()}})}function i(){$("#nomoredata").animate({opacity:0},500,"ease-out")}var r=new Array,o=null,d=!1,n=!1,c=window.innerHeight,_=$("body").height();$(".manual_but").on("click",function(){var a=location.protocol+"//"+location.host+"/prepaid/v1/page/b/mrecharge/index.html?c="+e.get_hash("c");s.goto_url(a)}),$(".js_member_detail").get(0)&&~function(){$(document).ready(function(){l(),t()})}(),$(window).on("scroll",function(e){var a=document.documentElement.scrollTop||document.body.scrollTop;a<_-c?clearTimeout(o):(e.stopPropagation(),d&&($(".load").show(),d=!1,o=window.setTimeout(t,2e3)),n&&($("#nomoredata").animate({opacity:.7},500,"ease-out"),window.setTimeout(i,2e3),n=!1))}),a.close_tip()})})});
//# sourceMappingURL=../../maps/js/b/member_detail.js.map
