{"version":3,"sources":["recharge/recharge_info.js"],"names":["timedCount","time0","$","text","t","setTimeout","clearTimeout","show","hide","require","yanzheng","add_bounced","ajax_rule","iosselect","date_day","wxjsbridge","if_code","code","data_code","captcha","mobile","val","get_code_succ","get_codeerror","parents","removeClass","addClass","get_code","return_data","get_shopname","shopname","get_tel","get_rechargesub","data_cz","c","get_hash","h","o","grid_index","recharge_su","window","location","href","url","error_yz","id","seccuss_yz","num_change_long","num","hide_menu","get","document","ready","attr","data_name","data_tel","on","tel_test_all","hasClass","mobile_val","data","html","showDom","querySelector","year","dataset","month","day","time_free","start_year","end_year","nowYear","yearData","monthData","dateData","container","title","itemHeight","itemShowCount","relation","oneLevelId","twoLevelId","threeLevelId","callback","year_data","month_data","day_data","value","name","birth","tel","china_test_all","detail_test_all","bir","split","bir_y","bir_m","bir_d","code_test_all","bor_red_num","length","birthday","this","crash_now_strend","replace","substr","close_tip"],"mappings":"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","file":"../../../js/recharge/recharge_info.js","sourcesContent":["\"use strict\";\n\nrequire(['../require-config'], function () {\n    require([\"zepto\", \"yanzheng\", \"add_bounced\", \"ajax_rule\", \"iosselect\", \"date_day\", \"wxjsbridge\"], function ($, yanzheng, add_bounced, ajax_rule, iosselect, date_day, wxjsbridge) {\n        $(function () {\n            //隐藏微信菜单           \n            wxjsbridge.hide_menu();\n            //填写信息----------------------------------------------------------------------------------------------------------------------------------------------------\n            $('.js_bindinfo').get(0) && ~function () {\n                $(document).ready(function () {\n                    //设置默认生日\n                    $('#birthday').val('1980-1-1');\n                    $('.js_message_birth').attr('data-year', '1980');\n                    $('.js_message_birth').attr('data-month', '1');\n                    $('.js_message_birth').attr('data-day', '1');\n                    //获取店铺名称--需要增加\n                    var data_name = {\n                        'h': yanzheng.get_hash('h')\n                    };\n                    ajax_rule.ajax_rule('/prepaid/v1/api/c/merchant_info', 'GET', 'json', data_name, '.zheceng', get_shopname);\n                });\n            }();\n            //信息确认----------------------------------------------------------------------------------------------------------------------------------------------------\n            $('.js_bindinfo_confirm').get(0) && ~function () {\n                $(document).ready(function () {\n                    //获取店铺名称--需要增加\n                    var data_name = {\n                        'h': yanzheng.get_hash('h')\n                    };\n                    ajax_rule.ajax_rule('/prepaid/v1/api/c/merchant_info', 'GET', 'json', data_name, '.zheceng', get_shopname);\n                    //获取储值账户\n                    var data_tel = {\n                        'c': yanzheng.get_hash('c')\n                    };\n                    ajax_rule.ajax_rule('/prepaid/v1/api/c/bindinfo', 'GET', 'json', data_tel, '.zheceng1', get_tel);\n                });\n                $('.js_alert_message2').on('click', function () {\n                    get_rechargesub();\n                });\n            }();\n\n            //获取验证码\n            $('.js_get_entycode').on('click', function () {\n                //验证\n                yanzheng.tel_test_all('.js_message_tel', error_yz, seccuss_yz);\n                if ($('.js_message_tel').parents('dl').hasClass('error_data')) {\n                    return false;\n                } else {\n                    //获取值\n                    var mobile_val = $('.js_message_tel').val();\n                    var url = '/prepaid/v1/api/c/captcha';\n                    var data = {\n                        'c': yanzheng.get_hash('c'),\n                        'h': yanzheng.get_hash('h'),\n                        'mobile': mobile_val\n                    };\n                    //获取验证码--todo--show\n                    ajax_rule.ajax_rule(url, 'GET', 'json', data, '.zheceng', get_code);\n                    //get_code(); //测试倒计时\n                }\n            });\n            //倒计时不可点击\n            $('.js_show_entycode').on('click', function () {\n                $('.alert_con').show();\n                $('.alert_con .alert_con_br').html(\"一分钟后再次获取！\");\n                $('.zheceng').show();\n            });\n            //点击生日\n            $('.js_message_birth').on('click', function () {\n                var showDom = document.querySelector('.js_message_birth');\n                var year = showDom.dataset['year'];\n                var month = showDom.dataset['month'];\n                var day = showDom.dataset['day'];\n                //设置开始和结束的年份\n                date_day.time_free.start_year = 1947;\n                date_day.time_free.end_year = date_day.nowYear;\n                var bankSelect = new iosselect(3, [date_day.yearData, date_day.monthData, date_day.dateData], {\n                    container: '.ios_select_container',\n                    title: '选择生日日期',\n                    itemHeight: 50,\n                    itemShowCount: 3,\n                    relation: [1, 1, 0, 0],\n                    oneLevelId: year,\n                    twoLevelId: month,\n                    threeLevelId: day,\n                    //showLoading: true,\n                    callback: function callback(year_data, month_data, day_data) {\n                        showDom.dataset['year'] = year_data.id;\n                        showDom.dataset['month'] = month_data.id;\n                        showDom.dataset['day'] = day_data.id;\n                        showDom.value = year_data.id + '年' + month_data.id + '月' + day_data.id + '日';\n                        $('#birthday').val(year_data.id + '-' + month_data.id + '-' + day_data.id);\n                    }\n                });\n            });\n            //点击填写信息确定按钮\n            $('.js_alert_message').on('click', function () {\n                //验证输入\n                var name = $('.js_message_name').val();\n                var birth = $('.js_message_birth').val();\n                var tel = $('.js_message_tel').val();\n                var code = $('.js_code').val();\n                yanzheng.tel_test_all('.js_message_tel', error_yz, seccuss_yz);\n                yanzheng.china_test_all('.js_message_name', 0, 4, error_yz, seccuss_yz);\n                yanzheng.detail_test_all('.js_message_birth', -1, 20, error_yz, seccuss_yz);\n                if (birth) {\n                    var bir = $('#birthday').val().split('-');\n                    var bir_y = bir[0];\n                    var bir_m = num_change_long(bir[1]);\n                    var bir_d = num_change_long(bir[2]);\n                    birth = bir_y + '-' + bir_m + '-' + bir_d;\n                    $('#birthday').val(bir_y + '-' + bir_m + '-' + bir_d);\n                }\n                //校验验证码\n                yanzheng.code_test_all('.js_code', error_yz, seccuss_yz);\n                var bor_red_num = $('.error_data').length;\n                if (bor_red_num > 0) {\n                    return false;\n                }\n                // //获取验证码--todo--show---取消\n                // var data_code = {\n                //     'captcha': code,\n                //     'mobile': tel,\n                // };\n                // ajax_rule.ajax_rule('/prepaid/v1/api/c/captcha', 'POST', 'json', data_code, '.zheceng', get_code_succ,get_codeerror); \n                var data_cz = {\n                    'c': yanzheng.get_hash('c'),\n                    'grid_index': yanzheng.get_hash('grid_index'),\n                    'name': name,\n                    'mobile': tel,\n                    'birthday': birth,\n                    'captcha': code\n                };\n                ajax_rule.ajax_rule('/prepaid/v1/api/c/bindinfo', 'POST', 'json', data_cz, '.zheceng1', get_rechargesub);\n            });\n            //校验验证码\n            $('.js_code').on('input', function () {\n                //验证必须填写了手机号\n                var tel = $('.js_message_tel').val();\n                yanzheng.tel_test_all('.js_message_tel', error_yz, seccuss_yz);\n                if ($('.js_message_tel').parents('dl').hasClass('error_data')) {\n                    $(this).val('');\n                    return false;\n                }\n                //验证验证码\n                var code = $(this).val();\n                //将非数字的字符替换为空\n                var crash_now_strend = code.replace(/[^\\d]/g, '');\n                //如果输入长度为6\n                if (crash_now_strend.length < 6) {\n                    $(this).val(crash_now_strend);\n                    return false;\n                }\n                $(this).val(crash_now_strend.substr(0, 6));\n                if_code($(this).val());\n            });\n            //输入过程中校验验证码\n            function if_code(code) {\n                //获取验证码--todo--show---取消\n                var data_code = {\n                    'captcha': code,\n                    'mobile': $('.js_message_tel').val()\n                };\n                ajax_rule.ajax_rule('/prepaid/v1/api/c/captcha', 'POST', 'json', data_code, '.zheceng', get_code_succ, get_codeerror);\n            }\n            //验证码验证正确\n            function get_code_succ() {\n                $('.js_code').parents('dl').removeClass('error_data');\n                $('.js_alert_message_disa').hide();\n                $('.js_alert_message').show();\n            }\n            //验证码验证错误\n            function get_codeerror() {\n                $('.js_code').parents('dl').addClass('error_data');\n                $('.js_alert_message_disa').show();\n                $('.js_alert_message').hide();\n            }\n            //获取验证码-时候等待\n            function get_code(return_data) {\n                $('.js_get_entycode').hide();\n                $('.js_show_entycode').show();\n                timedCount();\n            }\n            //获取店铺名称\n            function get_shopname(return_data) {\n                $('.js_shopname').text(return_data.shopname);\n            }\n            //获取储值账号\n            function get_tel(return_data) {\n                $('.js_message_tel').val(return_data.mobile);\n            }\n            //验证码验证正确--取消\n            function get_code_succ_lost() {\n                $('.js_code').parents('dl').removeClass('error_data');\n                //提交充值  \n                var name = $('.js_message_name').val();\n                var birth = $('#birthday').val();\n                var tel = $('.js_message_tel').val();\n                var code = $('.js_code').val();\n                var data_cz = {\n                    'c': yanzheng.get_hash('c'),\n                    'grid_index': yanzheng.get_hash('grid_index'),\n                    'name': name,\n                    'mobile': tel,\n                    'birthday': birth,\n                    'captcha': code\n                };\n                ajax_rule.ajax_rule('/prepaid/v1/api/c/bindinfo', 'POST', 'json', data_cz, '.zheceng1', get_rechargesub);\n            }\n            //点击购买\n            function get_rechargesub() {\n                var data_cz = {\n                    'c': yanzheng.get_hash('c'),\n                    'h': yanzheng.get_hash('h'),\n                    'o': yanzheng.get_hash('o'),\n                    'grid_index': yanzheng.get_hash('grid_index')\n                };\n                ajax_rule.ajax_rule('/prepaid/v1/api/c/recharge', 'POST', 'json', data_cz, '.zheceng2', recharge_su);\n            }\n            //验证码输入错误\n            function recharge_su(return_data) {\n                window.location.href = return_data.url;\n            }\n            //验证错误\n            function error_yz(id) {\n                $(id).parents('dl').addClass('error_data');\n            }\n            //验证错误\n            function error_yz(id) {\n                $(id).parents('dl').addClass('error_data');\n            }\n            //验证正确\n            function seccuss_yz(id) {\n                $(id).parents('dl').removeClass('error_data');\n            }\n            //提起补全\n            function num_change_long(num) {\n                var num = num - 0;\n                if (num < 10) {\n                    return '0' + num;\n                } else {\n                    return num;\n                }\n            }\n            //添加弹框\n            add_bounced.add_bounced();\n            //关闭弹框\n            add_bounced.close_tip();\n        });\n    });\n});\n//倒计时60s\nfunction timedCount() {\n    var time0 = $('.js_show_entycode i').text();\n    $('.js_show_entycode i').text(time0 - 1);\n    t = setTimeout(\"timedCount()\", 1000);\n    if (time0 == 0) {\n        clearTimeout(t);\n        $('.js_get_entycode').show();\n        $('.js_show_entycode i').text(61);\n        $('.js_show_entycode').hide();\n    }\n}"]}