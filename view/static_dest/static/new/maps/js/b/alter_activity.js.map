{"version":3,"sources":["b/alter_activity.js"],"names":["delete_rule","obj","dd_list","$","length","parents","remove","removeClass","find","css","require","yanzheng","ajax_rule","localstorage","iosselect","date_get","alert_word","time_area","startime","endtime","tips_pic","val","s_year","attr","s_month","s_day","e_year","e_month","e_day","s_time","e_time","s_time_s","Date","getTime","e_time_s","today_time_s","today_times","hasClass","addClass","html","get_alldata","return_data","countdown","countdown_day","removeAttr","rules","merchant_name","info","startime_data","start_time","endtime_data","end_time","mch_mobile","desc","focus","wordtip","text","substr","startime_zu","split","data","num_change","endtime_zu","i","dd_detail","chu_value","pay_amt","toFixed","song_value","present_amt","index_value","grid_index","append","document","eq","num","get_shopname","nowYear","nowMonth","nowDate","ready","toast_data_short","on","showDom","querySelector","year","dataset","month","day","yearData","monthData","dateData","container","title","itemHeight","itemShowCount","relation","oneLevelId","twoLevelId","threeLevelId","callback","year_data","month_data","day_data","id","value","this","crash_now_str","crash_now_strend","replace","crash_end_z","crash_end_z_first","crash_end_l","len_val","len","window","navigator","appVersion","match","test","userAgent","hide","blur","show","tel_activity","name_test","each","numprice_test","alert_word_show_short","error_len","set_storage","chu_len","chu_html","chu_val","song_val","rule","push","setone_storage","JSON","stringify","location","href","protocol","host"],"mappings":"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","file":"../../../js/b/alter_activity.js","sourcesContent":["//删除规则\nfunction delete_rule(obj) {\n    var dd_list = $('.js_rule dd').length - 0;\n    if (dd_list == 2) {\n        //删除第一条数据后面的删除按钮\n        $(obj).parents('dd').remove();\n        $('.js_rule dd i.js_ruledelete').remove();\n    }\n    $(obj).parents('dd').remove();\n    $('.js_rule_error').removeClass('span_tips');\n    $('.js_add_activity').find('.add_rule').css('display', 'inline-block');\n    $('.js_add_activity').find('.add_rule_no').css('display', 'none');\n}\nrequire(['../require-config'], function() {\n    require([\"zepto\", \"yanzheng\", \"ajax_rule\", \"localstorage\", \"iosselect\", \"date_get\", \"alert_word\"], function($, yanzheng, ajax_rule, localstorage, iosselect, date_get, alert_word) {\n        $(function() {\n            //设置菜单空---取消了native的引用0106\n            // var menu_data = { menus: [] };\n            // native.setNavMenu(menu_data, function(cb) {\n            //     console.log(cb.ret);\n            // });\n            var today_times = date_get.nowYear + '/' + date_get.nowMonth + '/' + date_get.nowDate + ' 00:00:00';\n            //设置储值活动----------------------------------------------------------------------------------------------------------------------------------------------------\n            $(document).ready(function() {\n                //加载提示弹框\n                alert_word.toast_data_short('body', '金额需大于0且不超过2000');\n                //获取店铺名称\n                var data_shopname = {};\n                ajax_rule.ajax_rule('/prepaid/v1/api/b/merchant_info', 'GET', 'json', '', '.zheceng', get_shopname);\n                //获取初始值todo\n                ajax_rule.ajax_rule('/prepaid/v1/api/b/cur_activity', 'GET', 'json', '', '.zheceng1', get_alldata);\n                //测试数据--todo--删除\n                // return_data = {\n                //     \"info\": {\n                //         \"start_time\": \"2016-09-02 11:22:33\", // 活动开始时间\n                //         \"end_time\": \"2017-07-06 22:22:22\", // 活动结束时间\n                //         \"activity_id\": 1234567, // 活动ID,唯一标志一次活动\n                //         \"mch_mobile\": \"13012349876\", // 商户联系电话\n                //         \"active\": 1, // 活动是否有效. 1 有效, 0 无效(商户主动停止)\n                //         \"desc\": \"活动说明\" // 活动说明\n                //     },\n                //     \"rules\": [ // 最多4条,至少1条\n                //         {\n                //             \"grid_index\": 1, // 储值规则格位: 目前可选: 1, 2, 3, 4\n                //             \"pay_amt\": 5000, // 支付金额, 单位: 分\n                //             \"present_amt\": 500, // 赠送金额, 单位: 分\n                //         }, {\n                //             \"grid_index\": 1, // 储值规则格位: 目前可选: 1, 2, 3, 4\n                //             \"pay_amt\": 50000, // 支付金额, 单位: 分\n                //             \"present_amt\": 5000, // 赠送金额, 单位: 分\n                //         }, {\n                //             \"grid_index\": 1, // 储值规则格位: 目前可选: 1, 2, 3, 4\n                //             \"pay_amt\": 10000, // 支付金额, 单位: 分\n                //             \"present_amt\": 1000, // 赠送金额, 单位: 分\n                //         }, \n                //         // {\n                //         //     \"grid_index\": 1, // 储值规则格位: 目前可选: 1, 2, 3, 4\n                //         //     \"pay_amt\": 66000, // 支付金额, 单位: 分\n                //         //     \"present_amt\": 600, // 赠送金额, 单位: 分\n                //         // },\n                //     ],\n                //     \"countdown\": 172800, // 活动还有多少秒开始, 单位: 秒\n                //     \"countdown_day\": 0, // 活动还有多少天开始, 单位: 天. 向上取整, 如1.5天 -> 2天\n                // };\n                // get_alldata(return_data);\n            });\n            //点击开始时间\n            $('.js_startime').on('click', function() {\n                var showDom = document.querySelector('.js_startime');\n                var year = showDom.dataset['year'];\n                var month = showDom.dataset['month'];\n                var day = showDom.dataset['day'];\n\n                var bankSelect = new iosselect(3, [date_get.yearData, date_get.monthData, date_get.dateData], {\n                    container: '.ios_select_container',\n                    title: '选择开始时间',\n                    itemHeight: 50,\n                    itemShowCount: 3,\n                    relation: [1, 1, 0, 0],\n                    oneLevelId: year,\n                    twoLevelId: month,\n                    threeLevelId: day,\n                    //showLoading: true,\n                    callback: function(year_data, month_data, day_data) {\n                        showDom.dataset['year'] = year_data.id;\n                        showDom.dataset['month'] = month_data.id;\n                        showDom.dataset['day'] = day_data.id;\n                        showDom.value = month_data.id + '月' + day_data.id + '日';\n                        $('#startime').val(year_data.id + '-' + month_data.id + '-' + day_data.id);\n                        //设置结束时间的默认时间--开始时间\n                        // $('.js_endtime').attr('data-year', year_data.id);\n                        // $('.js_endtime').attr('data-month', month_data.id);\n                        // $('.js_endtime').attr('data-day', day_data.id);\n                    }\n                });\n            });\n            //点击到期时间\n            $('.js_endtime').on('click', function() {\n                var showDom = document.querySelector('.js_endtime');\n                var year = showDom.dataset['year'];\n                var month = showDom.dataset['month'];\n                var day = showDom.dataset['day'];\n\n                var bankSelect = new iosselect(3, [date_get.yearData, date_get.monthData, date_get.dateData], {\n                    container: '.ios_select_container',\n                    title: '选择结束时间',\n                    itemHeight: 50,\n                    itemShowCount: 3,\n                    relation: [1, 1, 0, 0],\n                    oneLevelId: year,\n                    twoLevelId: month,\n                    threeLevelId: day,\n                    //showLoading: true,\n                    callback: function(year_data, month_data, day_data) {\n                        showDom.dataset['year'] = year_data.id;\n                        showDom.dataset['month'] = month_data.id;\n                        showDom.dataset['day'] = day_data.id;\n                        showDom.value = month_data.id + '月' + day_data.id + '日';\n                        $('#endtime').val(year_data.id + '-' + month_data.id + '-' + day_data.id);\n                    }\n                });\n            });\n            //点击增加规则\n            $('.js_add_activity').on('click', function() {\n                if ($(this).attr('data-click') != '1') {\n                    return false;\n                }\n                var dd_list = $('.js_rule dd').length - 0;\n                var dd_detail = '<dd data-index=\"\">储值<input class=\"text text_short js_chu js_storule\" type=\"tel\" value=\"\" name=\"pay_amt\" />元送<input class=\"text text_short js_song js_storule\" type=\"tel\" value=\"\" name=\"present_amt\" />元<i class=\"delete js_ruledelete\" onclick=\"delete_rule(this)\"></i></dd>';\n                if (dd_list <= 3) {\n                    if (dd_list == 1) {\n                        //第一条增加删除按钮\n                        $('.js_rule dd').append('<i class=\"delete js_ruledelete\" onclick=\"delete_rule(this)\"></i>');\n                    }\n                    if (dd_list == 3) {\n                        //设置为不可添加的按钮样式\n                        $(this).find('.add_rule').css('display', 'none');\n                        $(this).find('.add_rule_no').css('display', 'inline-block');\n                    }\n                    $('.js_rule').append(dd_detail);\n                    $('.js_rule_error').removeClass('span_tips');\n                } else {\n                    $('.js_rule_error').addClass('span_tips');\n                }\n            });\n            //点击删除规则\n            // $(document).on('click', '.js_ruledelete', function() {\n            //     var dd_list = $('.js_rule dd').length - 0;\n            //     if (dd_list == 2) {\n            //         //删除第一条数据后面的删除按钮\n            //         $(this).parents('dd').remove();\n            //         $('.js_rule dd i.js_ruledelete').remove();\n            //     }\n            //     $(this).parents('dd').remove();\n            //     $('.js_rule_error').removeClass('span_tips');\n            //     $('.js_add_activity').find('.add_rule').css('display', 'inline-block');\n            //     $('.js_add_activity').find('.add_rule_no').css('display', 'none');\n            // });\n            //填写储值赠送金额\n            $(document).on('input', '.js_storule', function() {\n                var crash_now_str = $(this).val();\n                //将非数字的字符替换为空\n                var crash_now_strend = crash_now_str.replace(/[^\\d]/g, '');\n                //如果输入为空展示全部提现\n                if (crash_now_strend.length == 0) {\n                    $(this).val('');\n                    return false;\n                }\n                if (crash_now_strend.length == 1 && crash_now_strend == '0') {\n                    $(this).val('');\n                    return false;\n                }\n                //整数部分最长4位start，且不大于2000\n                var crash_end_z = crash_now_strend.split('.')[0];\n                //如果整数部分首位为0，则截取后买的 \n                var crash_end_z_first = crash_end_z.substr(0, 1);\n                if (crash_end_z_first == '0') {\n                    crash_end_z = crash_end_z.substr(1);\n                }\n                if (crash_end_z.length > 4) {\n                    crash_end_z = crash_end_z.substr(0, 4);\n                }\n                if (crash_now_strend.split('.').length > 1) {\n                    var crash_end_l = crash_now_strend.split('.')[1].substr(0, 2);\n                    crash_now_strend = (crash_end_z - 0) + '.' + crash_end_l;\n                } else {\n                    crash_now_strend = crash_end_z - 0;\n                }\n                //整数部分最长12位end\n                //控制输入长度后赋值并将该值转化为字符串格式\n                $(this).val(crash_now_strend);\n            });\n            //填写备注验证\n            $('.js_note').on('input', function() {\n                var len_val = $(this).val();\n                var len = len_val.length - 0;\n                if (len <= 40) {\n                    $('.js_wordtip').find('span').text(40 - len);\n                } else {\n                    //$('.js_note').val(len_val.substr(0, 40));\n                    return false;\n                }\n            });\n            //测试输入框对浏览器的变化\n            if (window.navigator.appVersion.match(/iphone/gi) || (/Mac OS X/i).test(navigator.userAgent)) {\n                $('.js_note').on({\n                    'focus': function() {\n                        $('.section_footer').hide();\n                        // console.log('body===' + $('body').height());\n                        // console.log('availHeight===' + screen.availHeight);\n                        // var a = document.documentElement.scrollTop || document.body.scrollTop;\n                        // console.log('top===' + a);\n                    },\n                    'blur': function() {\n                        $('.section_footer').show();\n                    }\n                });\n                $('.js_tel').on({\n                    'focus': function() {\n                        $('.section_footer').hide();\n                    },\n                    'blur': function() {\n                        $('.section_footer').show();\n                    }\n                });\n                $(document).on('focus', '.js_storule', function() {\n                    $('.section_footer').hide();\n                });\n                $(document).on('blur', '.js_storule', function() {\n                    $('.section_footer').show();\n                });\n            }\n            //点击提交预览\n            $('.js_addactivity_sub').on('click', function() {\n                yanzheng.tel_activity('.js_tel');\n                yanzheng.name_test('.js_note', 0, 40);\n                time_area();\n                $('.js_storule').each(function() {\n                    yanzheng.numprice_test(this, 0, 4, 2000);\n                });\n                $('.js_storule').each(function() {\n                    if ($(this).hasClass('error_tips')) {\n                        alert_word.alert_word_show_short();\n                        return false;\n                    }\n                });\n                var error_len = $('.error_tips').length;\n                if (error_len > 0) {\n                    return false;\n                }\n                //存储数据并进入下一步\n                localstorage.set_storage();\n                //存储储值规则\n                var rules = [];\n                var chu_len = $('.js_rule dd').length;\n                for (var i = 0; i < chu_len; i++) {\n                    var chu_html = $('.js_rule dd').eq(i);\n                    var chu_key = chu_html.find('.js_chu').attr('name');\n                    var chu_val = chu_html.find('.js_chu').val();\n                    var song_key = chu_html.find('.js_song').attr('name');\n                    var song_val = chu_html.find('.js_song').val();\n                    var rule = { grid_index: i + 1, pay_amt: chu_val * 100, present_amt: song_val * 100 };\n                    rules.push(rule);\n                }\n                localstorage.setone_storage('rules', JSON.stringify(rules));\n                location.href = location.protocol + '//' + location.host + '/prepaid/v1/page/b/activity_preview.html?edit=mend';\n                // if (typeof QFPAY !== \"undefined\") {\n                //     var go_url = {\n                //         uri: location.protocol + '//' + location.host + '/prepaid/v1/page/b/activity_preview.html?edit=mend',\n                //     };\n                //     native.openUri(go_url, function(cb) {\n                //         console.log(cb.ret);\n                //     });\n                // } else {\n                //     location.href = location.protocol + '//' + location.host + '/prepaid/v1/page/b/activity_preview.html?edit=mend';\n                // }\n            });\n            //开始时间与结束时间的判断\n            function time_area() {\n                var startime = $('.js_startime');\n                var endtime = $('.js_endtime');\n                var tips_pic = '<i class=\"ic_tips\"></i>';\n                if (startime.val() && endtime.val()) {\n                    var s_year = startime.attr('data-year');\n                    var s_month = startime.attr('data-month');\n                    var s_day = startime.attr('data-day');\n                    var e_year = endtime.attr('data-year');\n                    var e_month = endtime.attr('data-month');\n                    var e_day = endtime.attr('data-day');\n                    var s_time = s_year + '/' + s_month + '/' + s_day + ' 00:00:00';\n                    var e_time = e_year + '/' + e_month + '/' + e_day + ' 23:59:59';\n                    var s_time_s = new Date(s_time).getTime();\n                    var e_time_s = new Date(e_time).getTime();\n                    var today_time_s = new Date(today_times).getTime();\n                    var s_cha = e_time_s - s_time_s;\n                    if (!startime.hasClass('grey')) {\n                        //活动开始前，判断开始时间\n                        if (s_time_s - today_time_s < 0) {\n                            $('.js_timetips').addClass('error_tips').find('span').html(tips_pic + '开始不能比今天早');\n                            return false;\n                        } else {\n                            $('.js_timetips').removeClass('error_tips').find('span').html('');\n                        }\n                    }\n                    if (e_time_s - s_time_s > 365 * 24 * 60 * 60 * 1000) {\n                        $('.js_timetips').addClass('error_tips').find('span').html(tips_pic + '时间范围在365天之内');\n                    } else if (e_time_s - s_time_s >= 0) {\n                        $('.js_timetips').removeClass('error_tips').find('span').html('');\n                    } else {\n                        $('.js_timetips').addClass('error_tips').find('span').html(tips_pic + '结束时间不能比开始时间早');\n                    }\n                } else {\n                    $('.js_timetips').addClass('error_tips').find('span').html(tips_pic + '时间范围在365天之内');\n                }\n            }\n            //获取所有信息\n            function get_alldata(return_data) {\n                //判断活动开始前与进行中\n                var countdown = return_data.countdown_day;\n                if (countdown > 0) {\n                    //活动开始前\n                    $('.js_startime').removeAttr('disabled').removeClass('grey');\n                    $('.js_tel').removeAttr('disabled').removeClass('grey');\n                } else {\n                    //活动进行中\n                    $('.js_startime').attr('disabled', 'disabled').addClass('grey');\n                    $('.js_tel').attr('disabled', 'disabled').addClass('grey');\n                }\n                //数据获取\n                var rules = return_data.rules;\n                var merchant_name = return_data.merchant_name;\n                var info = return_data.info;\n                var startime_data = info.start_time;\n                var endtime_data = info.end_time;\n                var mch_mobile = info.mch_mobile;\n                var desc = info.desc;\n                //赋值电话和备注、店铺名称\n                $('.js_shopname').val(merchant_name);\n                $('.js_tel').val(mch_mobile);\n                //添加选中事件，以便textarea数值显示               \n                $('.js_endtime').focus(); //该输入框input为readonly不会触发输入框事件，开始时间为disabled时失效\n                $('.js_note').val(desc);\n                // document.getElementById(\"js_note\").value=desc;\n                //document.getElementById(\"js_note\").innerText=desc;\n                //剩余可输入字数\n                var wordtip = desc.length - 0;\n                $('.js_wordtip span').text(40 - wordtip);\n                //日期\n                var startime = startime_data.substr(0, 10);\n                var startime_zu = startime.split('-');\n                if (startime) {\n                    $('.js_startime').data('year', startime_zu[0]);\n                    $('.js_startime').data('month', num_change(startime_zu[1]));\n                    $('.js_startime').data('day', num_change(startime_zu[2]));\n                    $('.js_startime').val(num_change(startime_zu[1]) + '月' + num_change(startime_zu[2]) + '日');\n                    $('#startime').val(startime_zu[0] + '-' + num_change(startime_zu[1]) + '-' + num_change(startime_zu[2]));\n                }\n                var endtime = endtime_data.substr(0, 10);\n                var endtime_zu = endtime.split('-');\n                if (endtime) {\n                    $('.js_endtime').data('year', endtime_zu[0]);\n                    $('.js_endtime').data('month', num_change(endtime_zu[1]));\n                    $('.js_endtime').data('day', num_change(endtime_zu[2]));\n                    $('.js_endtime').val(num_change(endtime_zu[1]) + '月' + num_change(endtime_zu[2]) + '日');\n                    $('#endtime').val(endtime_zu[0] + '-' + num_change(endtime_zu[1]) + '-' + num_change(endtime_zu[2]));\n                }\n                //储值规则--有退出，放置最后\n                if (!rules) {\n                    return false;\n                }\n                for (var i = 0; i < rules.length; i++) {\n                    var chu_value = (rules[i].pay_amt / 100).toFixed(0);\n                    var song_value = (rules[i].present_amt / 100).toFixed(0);\n                    var index_value = rules[i].grid_index;\n                    var dd_detail;\n                    //开始前与进行中判断\n                    if (countdown > 0) {\n                        dd_detail = '<dd data-index=\"' + index_value + '\">储值<input class=\"text text_short js_chu js_storule\" type=\"tel\" value=\"' + chu_value + '\" name=\"chu\" />元送<input class=\"text text_short js_song js_storule\" type=\"tel\" value=\"' + song_value + '\" name=\"song\" />元<i class=\"delete js_ruledelete\" onclick=\"delete_rule(this)\"></i></dd>';\n                    } else {\n                        dd_detail = '<dd data-index=\"' + index_value + '\">储值<input class=\"text text_short js_chu js_storule\" type=\"tel\" value=\"' + chu_value + '\" name=\"chu\" />元送<input class=\"text text_short js_song js_storule\" type=\"tel\" value=\"' + song_value + '\" name=\"song\" />元</dd>';\n                    }\n                    $('.js_rule').append(dd_detail);\n                }\n                //开始前与进行中判断\n                if (countdown > 0) {\n                    //活动开始前\n                    $('.js_storule').removeAttr('disabled').removeClass('grey');\n                    $('.js_add_activity').attr('data-click', '1');\n                } else {\n                    //活动进行中\n                    $('.js_storule').attr('disabled', 'disabled').addClass('grey');\n                    //杜绝添加按钮的点击时间\n                    $('.js_add_activity').attr('data-click', '0');\n                    //显示不可添加的图标\n                    $('.js_rule').find('.add_rule').css('display', 'none');\n                    $('.js_rule').find('.add_rule_no').css('display', 'inline-block');\n                    return false;\n                }\n                if (rules.length <= 1) {\n                    $(document).find('.js_rule dd').eq(0).find('i.js_ruledelete').remove();\n                }\n                if (rules.length >= 4) {\n                    $('.js_rule').find('.add_rule').css('display', 'none');\n                    $('.js_rule').find('.add_rule_no').css('display', 'inline-block');\n                } else {\n                    $('.js_rule').find('.add_rule').css('display', 'inline-block');\n                    $('.js_rule').find('.add_rule_no').css('display', 'none');\n                }\n            }\n            //把小于10的数值变成1位数\n            function num_change(num) {\n                if (num < 10) {\n                    return num.substr(-1);\n                } else {\n                    return num;\n                }\n            }\n            //获取店铺名称\n            function get_shopname(return_data) {\n                $('.js_shopname').val(return_data);\n            }\n        });\n    });\n});\n"]}