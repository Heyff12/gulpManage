{"version":3,"sources":["b/home_test.js"],"names":["require","$","close_tip","date_change","scroll_down","if_menu","native","stop_activity","ajax","url","type","dataType","data","beforeSend","show","success","respcd","html","css","hide","removeClass","siblings","addClass","error","complete","GetRTime","t","start_date","now_time","nD","Math","ceil","text","console","log","year","getFullYear","month","getMonth","day","getDate","today","tomorrow","today_end","Date","clearTimeout","timer_rt","window","setTimeout","menu_data","menus","uri","location","protocol","host","icon","title","setNavMenu","cb","ret","get","document","ready","js_h","height","js_button","js_body","js_window","innerHeight","floor","toFixed","on","tog_val","this","attr","parents","animate","opacity","GoTop","_hmt","push","url_val","goto_url","QFPAY","call","href","id","start_time","substr","replace","sys_time"],"mappings":"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","file":"../../../js/b/home_test.js","sourcesContent":["// var readyEvent = document.createEvent('Events');\n// readyEvent.initEvent('WebViewJavascriptBridgeReady');\n// readyEvent.bridge = WebViewJavascriptBridge;\n// document.dispatchEvent(readyEvent);\n//判断 处置活动首页显示右上角导航\n// document.addEventListener('WebViewJavascriptBridgeReady', function() {\n//     if (typeof QFPAY !== \"undefined\") {\n//         QFPAY.call('setNavMenu', {\n//             menus: [{\n//                 type: 'uri',\n//                 uri: location.protocol + '//' + location.host + '/prepaid/v1/page/b/transactions/consume.html',\n//                 icon: location.protocol + '//' + location.host + '/prepaid/v1/static/new/img/ic_mingxi.png',\n//                 title: '储值消费',\n//             }, {\n//                 type: 'uri',\n//                 uri: location.protocol + '//' + location.host + '/prepaid/v1/page/b/activity_history.html',\n//                 icon: location.protocol + '//' + location.host + '/prepaid/v1/static/new/img/ic_history.png',\n//                 title: '历史活动',\n//             }, {\n//                 type: 'uri',\n//                 uri: location.protocol + '//' + location.host + '/prepaid/v1/page/b/user_guide.html',\n//                 icon: location.protocol + '//' + location.host + '/prepaid/v1/static/new/img/ic_jiaocheng.png',\n//                 title: '储值教程',\n//             }],\n//             buttons: [\n\n//             ]\n//         }, function(cb) {\n//             console.log(cb.ret)\n//         })\n//     }\n// }, false);\nrequire(['../require-config'], function() {\n        require([\"zepto\", \"close_tip\", \"date_change\", \"scroll_down\", \"if_menu\", \"native\"], function($, close_tip, date_change, scroll_down, if_menu, native) {\n            $(function() {\n                var menu_data = {\n                    menus: [{\n                        type: 'uri',\n                        uri: location.protocol + '//' + location.host + '/prepaid/v1/page/b/transactions/consume.html',\n                        icon: location.protocol + '//' + location.host + '/prepaid/v1/static/new/img/ic_mingxi.png',\n                        title: '储值消费',\n                    }, {\n                        type: 'uri',\n                        uri: location.protocol + '//' + location.host + '/prepaid/v1/page/b/activity_history.html',\n                        icon: location.protocol + '//' + location.host + '/prepaid/v1/static/new/img/ic_history.png',\n                        title: '历史活动',\n                    }, {\n                        type: 'uri',\n                        uri: location.protocol + '//' + location.host + '/prepaid/v1/page/b/user_guide.html',\n                        icon: location.protocol + '//' + location.host + '/prepaid/v1/static/new/img/ic_jiaocheng.png',\n                        title: '储值教程',\n                    }]\n                };\n                native.setNavMenu(menu_data, function(cb) {\n                    console.log(cb.ret)\n                });\n                //判断 处置活动首页显示右上角导航\n                // document.addEventListener('WebViewJavascriptBridgeReady', function() {\n                //         if_menu.if_menu();\n                //     },false);\n                //储值首页----------------------------------------------------------------------------------------------------------------------------------------------------\n                //获取活动id--取消使用，数据合并\n                // var homepage_url = location.href;\n                // var activity_id;\n                // if (homepage_url.indexOf('?') != '-1') {\n                //     activity_id = homepage_url.split('?')[1].split('=')[1];\n                // }\n                //测试--js引入的html文件中单引号变双引号\n                var b = 'haha';\n                var a = '<a onclick=\"_hmt.push([\"_trackEvent\",\"usercenter\",\"click\",\"index_buy\"])\" href=\"#\" data-b=\"' + b + '\">立即储值</a>';\n                // $('.section_mid').append(a);\n                $('.js_activity_index').get(0) && (~ function() {\n                    $(document).ready(function() {\n                        //获取所有活动信息\n                        //get_activities();\n                        //获取活动信息todo-show\n                        //get_activity();\n                        //获取当前活动信息--取消，加载在上一个请求中\n                        //get_activitie_now(); \n                    });\n                    //点击切换活动详情                \n                    var js_h = Math.ceil($('.js_toogle_detail').height());\n                    var js_button = Math.ceil($('.js_ul_button').height());\n                    var js_body = Math.ceil($('body').height());\n                    var js_window = Math.ceil(window.innerHeight);\n                    var js_cha = Math.floor(js_body - js_window).toFixed(0);\n                    console.log(js_h);\n                    console.log(js_button);\n                    $('.js_toogle').on('click', function() {\n                        var tog_val = $(this).attr('data-toogle');\n                        if (tog_val === '1') {\n                            $(this).attr('data-toogle', '0');\n                            $(this).parents('.section_detail').addClass('arrow_t');\n                            //js实现动态效果\n                            $('.js_toogle_detail').animate({ opacity: 1, height: js_button + 'px' }, 1000);\n                            $('.js_ul_detail').animate({ opacity: 0 }, 1000);\n                            $('.js_title_normal').animate({ opacity: 0 }, 1000);\n                        } else {\n                            $(this).attr('data-toogle', '1');\n                            $(this).parents('.section_detail').removeClass('arrow_t');\n                            //js实现动态效果\n                            $('.js_toogle_detail').animate({ opacity: 1, height: js_h + 'px' }, 800, 'ease-in-out', function() {\n                                scroll_down.GoTop();\n                            });\n                            //$('.js_toogle_detail').animate({ opacity: 1, height: js_h + 'px'}, 600);\n                            $('.js_ul_detail').animate({ opacity: 1 }, 1000);\n                            $('.js_title_normal').animate({ opacity: 1 }, 1000);\n                            //setTimeout(scroll_down.GoTop(),1000)\n                            // if (js_cha > 0) {\n                            //     console.log(js_cha);\n                            //     $('html,body').animate({ scrollTop: js_cha + 'px' }, 1000);\n                            // }\n                        }\n                    });\n\n                    //跳到会员界面\n                    $('.js_goto_member').on('click', function() {\n                        _hmt.push(['_trackEvent', 'home', 'click', 'member_all']);\n                        var url_val = location.protocol + '//' + location.host + '/prepaid/v1/page/b/members/index.html';\n                        // location.href = url_val;\n                        if_menu.goto_url(url_val);\n                    });\n                    //跳到总储值流水\n                    $('.js_goto_allhistory').on('click', function() {\n                        _hmt.push(['_trackEvent', 'home', 'click', 'trade_all']);\n                        var url_val = location.protocol + '//' + location.host + '/prepaid/v1/page/b/transactions/recharge.html';\n                        if (typeof QFPAY !== \"undefined\") {\n                            QFPAY.call('openUri', {\n                                uri: url_val,\n                            }, function(cb) {\n                                console.log(cb.ret)\n                            })\n                        } else {\n                            location.href = url_val;\n                        }\n                    });\n                    //跳到当前活动流水\n                    $('.js_goto_nowhistory').on('click', function() {\n                        _hmt.push(['_trackEvent', 'home', 'click', 'activity_now']);\n                        var id = $(this).attr('data-id');\n                        var url_val = location.protocol + '//' + location.host + '/prepaid/v1/page/b/activity_detail.html/?activity_id=' + id;\n                        if (typeof QFPAY !== \"undefined\") {\n                            QFPAY.call('openUri', {\n                                uri: url_val,\n                            }, function(cb) {\n                                console.log(cb.ret)\n                            })\n                        } else {\n                            location.href = url_val;\n                        }\n                    });\n                    //跳到下载宣传物料界面\n                    $('.js_loadpic_sub').on('click', function() {\n                        var url_val = location.protocol + '//' + location.host + '/prepaid/v1/page/b/show_material.html';\n                        if_menu.goto_url(url_val);\n                    });\n                    //跳到创建储值活动\n                    $('.js_content_sub').on('click', function() {\n                        var url_val = location.protocol + '//' + location.host + '/prepaid/v1/page/b/create_activity.html';\n                        if_menu.goto_url(url_val);\n                    });\n                    //跳到修改储值活动\n                    $('.js_content_mend').on('click', function() {\n                        var url_val = location.protocol + '//' + location.host + '/prepaid/v1/page/b/alter_activity.html';\n                        if_menu.goto_url(url_val);\n                    });\n                    //停止活动\n                    $('.js_stop_activity').on('click', function() {\n                        stop_activity();\n                    });\n                    //fixed更改成absolute，进行top随滚动的调整-----------------start--暂不需要\n                    // var auchorTop = $(\".section_footer\").css(\"top\");\n                    // auchorTop = Number(auchorTop.substring(0, auchorTop.indexOf(\"p\"))); //首先在监听器外部记录某id=anchor的标签的初始位置 \n                    // var top = document.documentElement.scrollTop || document.body.scrollTop;\n                    // var body_height = $('body').height();\n                    // // console.log(auchorTop);\n                    // // console.log(top);\n                    // // console.log(body_height);\n                    // $(\".section_footer\").css(\"bottom\", \"0px\");\n                    // window.onscroll = function(e) {\n                    //     top = document.documentElement.scrollTop || document.body.scrollTop;\n                    //     $(\".section_footer\").css(\"top\", auchorTop + top + \"px\");\n                    // };\n                    //fixed更改成absolute，进行top随滚动的调整-------------------end\n                }());\n                //获取所有活动信息\n                function get_activities() {\n                    $.ajax({\n                        url: '/prepaid/v1/api/b/stat/activities',\n                        type: 'GET',\n                        dataType: 'json',\n                        data: {},\n                        beforeSend: function() {\n                            $('#loading').show();\n                            $('.zheceng1').show();\n                        },\n                        success: function(data) {\n                            if (data.respcd != '0000') {\n                                $('#alert_alert').show();\n                                $('.zheceng1').show();\n                                if (!data['respmsg']) {\n                                    $('#alert_alert .alert_con_br').html(data['resperr']);\n                                } else {\n                                    $('#alert_alert .alert_con_br').html(data['respmsg']);\n                                }\n                            } else {\n                                var return_data = data.data;\n                                var total_txamt = (return_data.total_pay_amt / 100).toFixed(0);\n                                $('.js_all_person').text(return_data.user_num);\n                                $('.js_all_money').text(total_txamt);\n                                $('.zheceng1').hide();\n                            }\n                        },\n                        error: function(data) {\n                            $('#alert_alert').show();\n                            $('.zheceng1').show();\n                            //$('.alert_con .alert_con_br').html('XMLHttpRequest.readyState:'+XMLHttpRequest.readyState+',XMLHttpRequest.status:'+XMLHttpRequest.status+',textStatus:'+textStatus+'!');\n                            $('#alert_alert .alert_con_br').html('网络超时!');\n                        },\n                        complete: function() {\n                            $('#loading').hide();\n                        }\n                    });\n                }\n                //获取活动信息\n                function get_activity() {\n                    $.ajax({\n                        url: '/prepaid/v1/api/b/cur_activity',\n                        type: 'GET',\n                        dataType: 'json',\n                        data: {},\n                        beforeSend: function() {\n                            $('#loading').show();\n                            $('.zheceng').show();\n                        },\n                        success: function(data) {\n                            if (data.respcd != '0000') {\n                                $('#alert_alert').show();\n                                $('.zheceng').show();\n                                if (!data['respmsg']) {\n                                    $('#alert_alert .alert_con_br').html(data['resperr']);\n                                } else {\n                                    $('#alert_alert .alert_con_br').html(data['respmsg']);\n                                }\n                            } else {\n                                var data_r = data.data.info;\n                                //获取活动id--执行获取当前活动数据\n                                var return_data_activity_id = data_r.activity_id;\n                                $('.js_goto_nowhistory').attr('data-id', return_data_activity_id);\n                                if (!return_data_activity_id) {\n                                    //没有添加任何活动，返回都为空，则不执行下面事件\n                                    $('.js_now_person').text('0');\n                                    $('.js_now_money').text('0');\n                                    //过期无效--显示 创建活动，显示没有穿件活动,隐藏活动修改停止按钮\n                                    $('.js_date_activity').hide(); //隐藏时间\n                                    $('.js_activity_detail').hide(); //隐藏活动详情\n                                    $('.js_content_sub').show().css('display', 'inline-block');\n                                    $('.js_content_sub_disa').hide();\n                                    $('.js_loadpic_sub').hide();\n                                    $('.js_ac_noac').removeClass('title_none').siblings('.js_ac_date').addClass('title_none');\n                                    $('.js_ul_button').hide();\n                                    $('.zheceng').hide();\n                                    return false;\n                                }\n                                //获取当前活动人数 金额 规则\n                                get_activitie_now(return_data_activity_id);\n                                //获取备注\n                                var return_data_desc = data_r.desc;\n                                $('.js_title_normal').text('备注：' + return_data_desc);\n                                //获取时间\n                                var start_time = data_r.start_time;\n                                var end_time = data_r.end_time;\n                                var s_time = date_change.time_change(start_time);\n                                var e_time = date_change.time_change2(start_time, end_time);\n                                $('.js_start_time').text(s_time);\n                                $('.js_end_time').text(e_time);\n                                //验证是否过期\n                                var return_expired = data_r.active;\n                                if (return_expired == '1') {\n                                    //未过期--显示下载物料\n                                    $('.js_content_sub').hide();\n                                    $('.js_content_sub_disa').hide();\n                                    $('.js_loadpic_sub').show().css('display', 'inline-block');\n                                    $('.js_ul_button').show();\n                                } else {\n                                    //过期无效--显示 创建活动，显示活动结束,隐藏活动修改停止按钮\n                                    $('.js_content_sub').show().css('display', 'inline-block');\n                                    $('.js_content_sub_disa').hide();\n                                    $('.js_loadpic_sub').hide();\n                                    $('.js_ac_dateend').removeClass('title_none').siblings('.js_ac_date').addClass('title_none');\n                                    $('.js_ul_button').hide();\n                                    $('.zheceng').hide();\n                                    return false;\n                                }\n                                //活动是否开始判断\n                                var count_day = data.data.countdown_day - 0;\n                                var counting_day = data.data.countdown_end_day - 0;\n                                // var now_t=new Date();//todo_需要服务器传值\n                                // var start_t=start_time.substr(0,10).replace(/-/g, '/')+' 00:00:00';//更改样式，保证ie及相关浏览器兼容时间格式\n                                // var cha_t=now_t-new Date(start_t);\n                                if (count_day < 0) {\n                                    $('.js_ac_dateend').removeClass('title_none').siblings('.js_ac_date').addClass('title_none');\n                                } else if (count_day == 0) {\n                                    //活动进行中\n                                    $('.js_countdown_end').text(counting_day);\n                                    $('.js_ac_dateing').removeClass('title_none').siblings('.js_ac_date').addClass('title_none');\n                                } else {\n                                    //活动未开始\n                                    $('.js_countdown').text(count_day);\n                                    $('.js_ac_dateno').removeClass('title_none').siblings('.js_ac_date').addClass('title_none');\n                                }\n                                $('.zheceng').hide();\n                            }\n                        },\n                        error: function(data) {\n                            $('#alert_alert').show();\n                            $('.zheceng').show();\n                            //$('.alert_con .alert_con_br').html('XMLHttpRequest.readyState:'+XMLHttpRequest.readyState+',XMLHttpRequest.status:'+XMLHttpRequest.status+',textStatus:'+textStatus+'!');\n                            $('#alert_alert .alert_con_br').html('网络超时!');\n                        },\n                        complete: function() {\n                            $('#loading').hide();\n                        }\n                    });\n                }\n                //获取当前活动信息\n                function get_activitie_now(activity_id) {\n                    $.ajax({\n                        url: '/prepaid/v1/api/b/stat/activity/' + activity_id,\n                        type: 'GET',\n                        dataType: 'json',\n                        data: {},\n                        beforeSend: function() {\n                            $('#loading').show();\n                            $('.zheceng2').show();\n                        },\n                        success: function(data) {\n                            if (data.respcd != '0000') {\n                                $('#alert_alert').show();\n                                $('.zheceng2').show();\n                                if (!data['respmsg']) {\n                                    $('#alert_alert .alert_con_br').html(data['resperr']);\n                                } else {\n                                    $('#alert_alert .alert_con_br').html(data['respmsg']);\n                                }\n                            } else {\n                                var return_data = data.data;\n                                var total_txamt = (return_data.total_pay_amt / 100).toFixed(0);\n                                $('.js_now_person').text(return_data.user_num);\n                                $('.js_now_money').text(total_txamt);\n                                //获取活动规则\n                                var ac_detail = return_data.details;\n                                $(ac_detail).each(function(i, item) {\n                                    var now_user_num = ac_detail[i].user_num;\n                                    var now_title = ac_detail[i].title;\n                                    var li_detail = '<li><span class=\"fr\"><i class=\"i_normal\">' + now_user_num + '人</i>已购买</span>' + now_title + '</li>';\n                                    $(\".js_ul_detail\").append(li_detail);\n                                });\n                                js_h = Math.ceil($('.js_toogle_detail').height());\n                                scroll_down.scrolldown_data.body_height = $('body').height();\n                                //console.log(scroll_down.scrolldown_data.body_height); \n                                $('.zheceng2').hide();\n                                //判断动画是否出现\n                                donghua_if(activity_id);\n                            }\n                        },\n                        error: function(data) {\n                            $('#alert_alert').show();\n                            $('.zheceng2').show();\n                            //$('.alert_con .alert_con_br').html('XMLHttpRequest.readyState:'+XMLHttpRequest.readyState+',XMLHttpRequest.status:'+XMLHttpRequest.status+',textStatus:'+textStatus+'!');\n                            $('#alert_alert .alert_con_br').html('网络超时!');\n                        },\n                        complete: function() {\n                            $('#loading').hide();\n                        }\n                    });\n                }\n                //停止活动信息\n                function stop_activity() {\n                    $.ajax({\n                        url: '/prepaid/v1/api/b/activity/stop',\n                        type: 'POST',\n                        dataType: 'json',\n                        data: {},\n                        beforeSend: function() {\n                            $('#loading').show();\n                            $('.zheceng1').show();\n                        },\n                        success: function(data) {\n                            if (data.respcd != '0000') {\n                                $('#alert_alert').show();\n                                $('.zheceng1').show();\n                                if (!data['respmsg']) {\n                                    $('#alert_alert .alert_con_br').html(data['resperr']);\n                                } else {\n                                    $('#alert_alert .alert_con_br').html(data['respmsg']);\n                                }\n                            } else {\n                                //停止活动--显示 创建活动，显示活动结束,隐藏活动修改停止按钮\n                                $('.js_content_sub').show().css('display', 'inline-block');\n                                $('.js_content_sub_disa').hide();\n                                $('.js_loadpic_sub').hide();\n                                $('.js_ac_dateend').removeClass('title_none').siblings('.js_ac_date').addClass('title_none');\n                                $('.js_ul_button').hide();\n                                $('.zheceng1').hide();\n                            }\n                        },\n                        error: function(data) {\n                            $('#alert_alert').show();\n                            $('.zheceng1').show();\n                            //$('.alert_con .alert_con_br').html('XMLHttpRequest.readyState:'+XMLHttpRequest.readyState+',XMLHttpRequest.status:'+XMLHttpRequest.status+',textStatus:'+textStatus+'!');\n                            $('#alert_alert .alert_con_br').html('网络超时!');\n                        },\n                        complete: function() {\n                            $('#loading').hide();\n                        }\n                    });\n                }\n                //判断动画是否出现\n                function donghua_if(activity_id) {\n                    $.ajax({\n                        url: '/prepaid/v1/api/b/guide',\n                        type: 'GET',\n                        dataType: 'json',\n                        data: {\n                            'guide_type': 1,\n                            'activity_id': activity_id\n                        },\n                        beforeSend: function() {\n                            $('#loading').show();\n                            $('.zheceng').show();\n                        },\n                        success: function(data) {\n                            if (data.respcd != '0000') {\n                                $('#alert_alert').show();\n                                $('.zheceng').show();\n                                if (!data['respmsg']) {\n                                    $('#alert_alert .alert_con_br').html(data['resperr']);\n                                } else {\n                                    $('#alert_alert .alert_con_br').html(data['respmsg']);\n                                }\n                            } else {\n                                //停止活动--显示 创建活动，显示活动结束,隐藏活动修改停止按钮\n                                var return_data = data.data;\n                                var show = return_data.show;\n                                if (show == '1') {\n                                    // if (typeof QFPAY !== \"undefined\") {\n                                    //     QFPAY.call('openUri', {\n                                    //         uri: 'hjsh://ppay/guide'\n                                    //     }, function(cb) {\n                                    //         console.log(cb.ret)\n                                    //     })\n                                    // }\n                                    var url_data = { uri: 'hjsh://ppay/guide' };\n                                    native.openUri(url_data, function(cb) {\n                                        console.log(cb.ret);\n                                    });\n                                    //发送已调用动画\n                                    donghua_off(activity_id);\n                                }\n                                $('.zheceng').hide();\n                            }\n                        },\n                        error: function(data) {\n                            $('#alert_alert').show();\n                            $('.zheceng').show();\n                            //$('.alert_con .alert_con_br').html('XMLHttpRequest.readyState:'+XMLHttpRequest.readyState+',XMLHttpRequest.status:'+XMLHttpRequest.status+',textStatus:'+textStatus+'!');\n                            $('#alert_alert .alert_con_br').html('网络超时!');\n                        },\n                        complete: function() {\n                            $('#loading').hide();\n                        }\n                    });\n                }\n                //发送已调用动画\n                function donghua_off(activity_id) {\n                    $.ajax({\n                        url: '/prepaid/v1/api/b/guide',\n                        type: 'POST',\n                        dataType: 'json',\n                        data: {\n                            'guide_type': 1,\n                            'activity_id': activity_id\n                        },\n                        beforeSend: function() {\n                            $('#loading').show();\n                            $('.zheceng1').show();\n                        },\n                        success: function(data) {\n                            if (data.respcd != '0000') {\n                                $('#alert_alert').show();\n                                $('.zheceng1').show();\n                                if (!data['respmsg']) {\n                                    $('#alert_alert .alert_con_br').html(data['resperr']);\n                                } else {\n                                    $('#alert_alert .alert_con_br').html(data['respmsg']);\n                                }\n                            } else {\n\n                                $('.zheceng1').hide();\n                            }\n                        },\n                        error: function(data) {\n                            $('#alert_alert').show();\n                            $('.zheceng1').show();\n                            //$('.alert_con .alert_con_br').html('XMLHttpRequest.readyState:'+XMLHttpRequest.readyState+',XMLHttpRequest.status:'+XMLHttpRequest.status+',textStatus:'+textStatus+'!');\n                            $('#alert_alert .alert_con_br').html('网络超时!');\n                        },\n                        complete: function() {\n                            $('#loading').hide();\n                        }\n                    });\n                }\n                //关闭弹框\n                close_tip.close_tip();\n                //倒计时 --start \n                var start_time = '2016-11-23 09:00:00'.substr(0, 10).replace(/-/g, '/') + ' 00:00:00'; //更改样式，保证ie及相关浏览器兼容时间格式\n                var start_date = new Date(start_time);\n                var sys_time = '2016-11-21 12:00:00'.replace(/-/g, '/');\n                var now_time = new Date(sys_time); //服务器当前时间  \n                var timer_rt = null;\n\n                GetRTime();\n\n                function GetRTime() {\n                    //计算距离开始天数\n                    var t = start_date - now_time;\n                    var nD = Math.ceil(t / (1000 * 60 * 60 * 24));\n                    //document.getElementsByClassName('js_countdown').innerHTML=nD;\n                    $(\".js_countdown\").text(nD);\n                    console.log(t + '---' + nD);\n                    //计算距离今天结束剩余时间                \n                    var year = now_time.getFullYear();\n                    var month = now_time.getMonth() + 1;\n                    var day = now_time.getDate();\n                    var today = year + '/' + month + '/' + day + ' 23:59:59';\n                    var tomorrow = year + '/' + month + '/' + (day + 1) + ' 00:00:00';\n                    var today_end = new Date(today) - now_time;\n                    console.log(today + '-----' + today_end);\n                    console.log(new Date(tomorrow));\n\n                    if (t <= 0) {\n                        clearTimeout(timer_rt);\n                    } else {\n                        now_time = new Date(tomorrow);\n                        timer_rt = window.setTimeout(GetRTime, today_end);\n                    }\n                }\n\n                function native_callback() {\n                    console.log();\n                }\n\n            })\n        })\n    })\n    //调用菜单\n    // if (typeof QFPAY !== \"undefined\") {  \n    //     QFPAY.call('setNavMenu', {\n    //         menus: [{\n    //             type: 'uri',\n    //             uri: location.protocol + '//' + location.host + '/prepaid/v1/page/b/transactions/consume.html',\n    //             icon: location.protocol + '//' + location.host + '/prepaid/v1/static/new/img/ic_mingxi.png',\n    //             title: '储值消费',\n    //         },{\n    //             type: 'uri',\n    //             uri: location.protocol + '//' + location.host + '/prepaid/v1/page/b/activity_history.html',\n    //             icon: location.protocol + '//' + location.host + '/prepaid/v1/static/new/img/ic_history.png',\n    //             title: '历史活动',\n    //         },{\n    //             type: 'uri',\n    //             uri: location.protocol + '//' + location.host + '/prepaid/v1/page/b/user_guide.html',\n    //             icon: location.protocol + '//' + location.host + '/prepaid/v1/static/new/img/ic_jiaocheng.png',\n    //             title: '储值教程',\n    //         }],\n    //         buttons: [\n\n//         ]\n//     }, function(cb) {\n//         console.log(cb.ret)\n//     })\n// }\n// if (typeof QFPAY !== \"undefined\") {  \n//     QFPAY.call('setNavMenu', {\n//         menus: [{\n//             type: 'uri',\n//             uri: 'http://192.168.0.7:37013/prepaid/v1/page/b/transactions/consume.html',\n//             icon: 'http://192.168.0.7:37013/prepaid/v1/static/new/img/ic_mingxi.png',\n//             title: '储值消费',\n//         },{\n//             type: 'uri',\n//             uri: 'http://192.168.0.7:37013/prepaid/v1/page/b/activity_history.html',\n//             icon: 'http://192.168.0.7:37013/prepaid/v1/static/new/img/ic_history.png',\n//             title: '历史活动',\n//         },{\n//             type: 'uri',\n//             uri: 'http://192.168.0.7:37013/prepaid/v1/page/b/user_guide.html',\n//             icon:  'http://192.168.0.7:37013/prepaid/v1/static/new/img/ic_jiaocheng.png',\n//             title: '储值教程',\n//         }],\n//         buttons: [\n\n//         ]\n//     }, function(cb) {\n//         console.log(cb.ret)\n//     })\n// }\n"]}