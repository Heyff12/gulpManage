/**
 * rechargeB - rechargeB详情
 * @version v1.0.0
 * @link 
 * @license ISC
 */
function time_area(){var e=$(".js_startime"),t=$(".js_endtime");if(e.val()&&t.val()){var a=e.attr("data-year"),s=e.attr("data-month"),d=e.attr("data-day"),n=t.attr("data-year"),i=t.attr("data-month"),r=t.attr("data-day"),l=a+"/"+s+"/"+d+" 00:00:00",o=n+"/"+i+"/"+r+" 23:59:59",_=new Date(l).getTime(),u=new Date(o).getTime();u-_>31536e6?$(".js_timetips").addClass("error_tips"):$(".js_timetips").removeClass("error_tips")}else $(".js_timetips").addClass("error_tips")}function get_data(){var e=$(".js_note").val().length-0;$(".js_wordtip span").text(40-e);var t=$("#startime").val(),a=t.split("-");t?($(".js_startime").data("year",a[0]),$(".js_startime").data("month",a[1]),$(".js_startime").data("day",a[2]),$(".js_startime").val(a[1]+"月"+a[2]+"日")):($(".js_startime").data("year",date_get.nowYear),$(".js_startime").data("month",date_get.nowMonth),$(".js_startime").data("day",date_get.nowDate),$("#startime").val(date_get.nowYear+"-"+date_get.nowMonth+"-"+date_get.nowDate),$(".js_startime").val("今天"));var s=$("#endtime").val(),d=s.split("-");s?($(".js_endtime").data("year",d[0]),$(".js_endtime").data("month",d[1]),$(".js_endtime").data("day",d[2]),$(".js_endtime").val(d[1]+"月"+d[2]+"日")):($(".js_endtime").data("year",date_get.nowYear),$(".js_endtime").data("month",date_get.nowMonth),$(".js_endtime").data("day",date_get.nowDate),$("#endtime").val(date_get.nowYear+"-"+date_get.nowMonth+"-"+date_get.nowDate),$(".js_endtime").val(""));var n=JSON.parse(localstorage.getone_storage("rules"));if(!n)return!1;n.length>1?$(".js_rule dd").eq(0).append('<i class="delete js_ruledelete"></i>'):$(".js_rule dd").eq(0).find("i.js_ruledelete").remove(),n.length>=4?($(".js_rule").find(".add_rule").css("display","none"),$(".js_rule").find(".add_rule_no").css("display","inline-block")):($(".js_rule").find(".add_rule").css("display","inline-block"),$(".js_rule").find(".add_rule_no").css("display","none"));for(var i=0;i<n.length;i++){var r=n[i].chu_key,l=n[i].song_key,o=n[i].index;if(0==i)$(".js_rule dd").eq(0).find(".js_chu").val(r),$(".js_rule dd").eq(0).find(".js_song").val(l),$(".js_rule dd").eq(0).attr("data-index",o);else{var _='<dd data-index="'+o+'">储值<input class="text text_short js_chu js_storule" type="text" value="'+r+'" name="chu" />元送<input class="text text_short js_song js_storule" type="text" value="'+l+'" name="song" />元<i class="delete js_ruledelete"></i></dd>';$(".js_rule").append(_)}}}function get_shopname(e){$(".js_shopname").val(e.shopname)}var zepto=require("../plug/zepto.min"),yanzheng=require("../common/yanzheng"),add_bounced=require("../common/add_bounced"),ajax_rule=require("../common/ajax_rule"),localstorage=require("../common/localstorage"),iosselect=require("../common/iosselect"),date_get=require("../common/date_get");$(document).ready(function(){localstorage.get_storage(get_data)}),$(".js_startime").on("click",function(){var e=document.querySelector(".js_startime"),t=e.dataset.year,a=e.dataset.month,s=e.dataset.day;new iosselect(3,[date_get.yearData,date_get.monthData,date_get.dateData],{container:".ios_select_container",title:"选择开始时间",itemHeight:50,itemShowCount:3,relation:[1,1,0,0],oneLevelId:t,twoLevelId:a,threeLevelId:s,callback:function(t,a,s){e.dataset.year=t.id,e.dataset.month=a.id,e.dataset.day=s.id,e.value=a.id+"月"+s.id+"日",$("#startime").val(t.id+"-"+a.id+"-"+s.id),$(".js_endtime").attr("data-year",t.id),$(".js_endtime").attr("data-month",a.id),$(".js_endtime").attr("data-day",s.id)}})}),$(".js_endtime").on("click",function(){var e=document.querySelector(".js_endtime"),t=e.dataset.year,a=e.dataset.month,s=e.dataset.day;new iosselect(3,[date_get.yearData,date_get.monthData,date_get.dateData],{container:".ios_select_container",title:"选择结束时间",itemHeight:50,itemShowCount:3,relation:[1,1,0,0],oneLevelId:t,twoLevelId:a,threeLevelId:s,callback:function(t,a,s){e.dataset.year=t.id,e.dataset.month=a.id,e.dataset.day=s.id,e.value=a.id+"月"+s.id+"日",$("#endtime").val(t.id+"-"+a.id+"-"+s.id)}})}),$(".js_add_activity").on("click",function(){var e=$(".js_rule dd").length-0,t='<dd data-index="">储值<input class="text text_short js_chu js_storule" type="text" value="" name="chu" />元送<input class="text text_short js_song js_storule" type="text" value="" name="song" />元<i class="delete js_ruledelete"></i></dd>';e<=3?(1==e&&$(".js_rule dd").append('<i class="delete js_ruledelete"></i>'),3==e&&($(this).find(".add_rule").css("display","none"),$(this).find(".add_rule_no").css("display","inline-block")),$(".js_rule").append(t),$(".js_rule_error").removeClass("span_tips")):$(".js_rule_error").addClass("span_tips")}),$(document).on("click",".js_ruledelete",function(){var e=$(".js_rule dd").length-0;2==e&&($(this).parents("dd").remove(),$(".js_rule dd i.js_ruledelete").remove()),$(this).parents("dd").remove(),$(".js_rule_error").removeClass("span_tips"),$(".js_add_activity").find(".add_rule").css("display","inline-block"),$(".js_add_activity").find(".add_rule_no").css("display","none")}),$(document).on("input",".js_storule",function(){var e=$(this).val();e.length<=10?$(this).css("font-size","16px"):$(this).css("font-size","14px");var t=e.replace(/[^\d]/g,"");if(0==t.length)return $(this).val(""),!1;if(1==t.length&&"0"==t)return $(this).val(""),!1;var a=t.split(".")[0],s=a.substr(0,1);if("0"==s&&(a=a.substr(1)),a.length>4&&(a=a.substr(0,4)),t.split(".").length>1){var d=t.split(".")[1].substr(0,2);t=a-0+"."+d}else t=a-0;$(this).val(t)}),$(".js_note").on("input",function(){var e=$(this).val(),t=e.length-0;t<=40?$(".js_wordtip").find("span").text(40-t):$(".js_note").val(e.substr(0,40))}),$(".js_addactivity_sub").on("click",function(){yanzheng.tel_activity(".js_tel"),yanzheng.name_test(".js_note",0,40),time_area(),$(".js_storule").each(function(){yanzheng.numprice_test(this,0,4)});var e=$(".error_tips").length;if(e>0)return!1;localstorage.set_storage();for(var t=[],a=$(".js_rule dd").length,s=0;s<a;s++){var d=$(".js_rule dd").eq(s),n=(d.find(".js_chu").attr("name"),d.find(".js_chu").val()),i=(d.find(".js_song").attr("name"),d.find(".js_song").val()),r={index:s+1,chu_key:n,song_key:i};t.push(r)}localstorage.setone_storage("rules",JSON.stringify(t)),location.href=location.protocol+"//"+location.host+"/Users/yaya/Documents/job/local/储值B端2/store/html/b/preview.html"}),add_bounced.add_bounced(),add_bounced.close_tip();