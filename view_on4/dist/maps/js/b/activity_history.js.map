{"version":3,"sources":["b/activity_history.js"],"names":["require","$","ajax_rule","scroll_more","date_change","get_history","data","pos","val","count","get_list","return_data","length","show","hide","addClass","removeClass","each","i","item","startime","start_time","endtime","end_time","activity_id","user_num","total_pay_amt","total_txamt","toFixed","detail","s_time","time_change_word","e_time","time_change_word2","p_str","ul_str","rule_str","grid_index","title","li_str","li_detail","append","pos_val","scroll_data","nomor_show","nomoredata_show","window","setTimeout","nomoredata_hide","scroll_if","body_height","Math","floor","height","add_load_img","document","ready"],"mappings":"AAAA,YAEAA,UAAS,qBAAsB,WAC3BA,SAAS,QAAS,YAAa,cAAe,eAAgB,SAAUC,EAAGC,EAAWC,EAAaC,GAC/FH,EAAE,WAYE,QAASI,KACL,GAAIC,IACAC,IAAON,EAAE,WAAWO,MACpBC,MAAS,GAEbP,GAAUA,UAAU,qCAAsC,MAAO,OAAQI,EAAM,WAAYI,GAG/F,QAASA,GAASC,GACd,GAA0B,GAAtBA,EAAYC,QAAqC,KAAtBX,EAAE,WAAWO,MAIxC,MAHAP,GAAE,eAAeY,OACjBZ,EAAE,6BAA6Ba,OAC/Bb,EAAE,QAAQc,SAAS,aACZ,CAEPd,GAAE,eAAea,OACjBb,EAAE,6BAA6BY,OAC/BZ,EAAE,QAAQe,YAAY,YAE1Bf,EAAEU,GAAaM,KAAK,SAAUC,EAAGC,GAC7B,GAAIC,GAAWT,EAAYO,GAAGG,WAC1BC,EAAUX,EAAYO,GAAGK,SACzBC,EAAcb,EAAYO,GAAGM,YAC7BC,EAAWd,EAAYO,GAAGO,SAE1BC,IADef,EAAYO,GAAGS,YAAc,KAAKC,QAAQ,IACxCjB,EAAYO,GAAGQ,cAAgB,KAAKE,QAAQ,IAC7DC,EAASlB,EAAYO,GAAGW,OACxBC,EAAS1B,EAAY2B,iBAAiBX,GACtCY,EAAS5B,EAAY6B,kBAAkBb,EAAUE,GACjDY,EAAQ,mBAAqBJ,EAAS,IAAME,EAAS,OACrDG,EAAS,mFAAqFV,EAAW,gFAAkFC,EAAgB,yBAC3MU,EAAW,oBACfnC,GAAE4B,GAAQZ,KAAK,SAAUC,EAAGC,GACxB,GAAIkB,GAAaR,EAAOX,GAAGmB,WACvBC,EAAQT,EAAOX,GAAGoB,MAClBb,EAAWI,EAAOX,GAAGO,SACrBc,EAAS,mBAAqBF,EAAa,0CAA4CZ,EAAW,kBAAoBa,EAAQ,OAClIF,IAAYG,IAEhBH,GAAY,OACZ,IAAII,GAAY,wBAA0BhB,EAAc,6BAA+BU,EAAQC,EAASC,EAAW,YACnHnC,GAAE,6BAA6BwC,OAAOD,KAE1CvC,EAAE,SAASa,MACX,IAAI4B,GAAUzC,EAAE,WAAWO,MAAQ,CAC/BG,GAAYC,OAAS,IACjBD,EAAYC,OAAS,EACrBT,EAAYwC,YAAYC,YAAa,GAErCzC,EAAY0C,kBACZC,OAAOC,WAAW5C,EAAY6C,gBAAiB,KAC/C7C,EAAYwC,YAAYC,YAAa,GAEzCzC,EAAYwC,YAAYM,WAAY,IAEpCP,GAAW,GACXzC,EAAE,WAAWO,IAAIkC,GACjBvC,EAAYwC,YAAYM,WAAY,GAExC9C,EAAYwC,YAAYO,YAAcC,KAAKC,MAAMnD,EAAE,QAAQoD,UAAUzB,QAAQ,GApEjFzB,EAAYmD,aAAa,QAEzBnD,EAAYA,YAAYE,GAExBJ,EAAEsD,UAAUC,MAAM,WAEdnD","file":"../../../js/b/activity_history.js","sourcesContent":["\"use strict\";\n\nrequire(['../require-config'], function () {\n    require([\"zepto\", \"ajax_rule\", \"scroll_more\", \"date_change\"], function ($, ajax_rule, scroll_more, date_change) {\n        $(function () {\n            //滚动加载---------------------------------------------------------------  \n            //添加图标和没有更多文字提示\n            scroll_more.add_load_img('#wap');\n            //默认滚动执行   \n            scroll_more.scroll_more(get_history);\n            //设置储值活动----------------------------------------------------------------------------------------------------------------------------------------------------\n            $(document).ready(function () {\n                //获取信息--todo\n                get_history();\n            });\n            //获取活动列表\n            function get_history() {\n                var data = {\n                    'pos': $('#js_pos').val(),\n                    'count': 10\n                };\n                ajax_rule.ajax_rule('/prepaid/v1/api/b/activity_history', 'GET', 'json', data, '.zheceng', get_list);\n            }\n            //获取列表成功数据\n            function get_list(return_data) {\n                if (return_data.length == 0 && $('#js_pos').val() == '0') {\n                    $('.js_li_none').show();\n                    $('.js_activityhistory_index').hide();\n                    $('body').addClass('bg_white');\n                    return false;\n                } else {\n                    $('.js_li_none').hide();\n                    $('.js_activityhistory_index').show();\n                    $('body').removeClass('bg_white');\n                }\n                $(return_data).each(function (i, item) {\n                    var startime = return_data[i].start_time;\n                    var endtime = return_data[i].end_time;\n                    var activity_id = return_data[i].activity_id;\n                    var user_num = return_data[i].user_num;\n                    var total_txamt = (return_data[i].total_txamt / 100).toFixed(0);\n                    var total_pay_amt = (return_data[i].total_pay_amt / 100).toFixed(0);\n                    var detail = return_data[i].detail; //活动信息\n                    var s_time = date_change.time_change_word(startime);\n                    var e_time = date_change.time_change_word2(startime, endtime);\n                    var p_str = '<p class=\"time\">' + s_time + '-' + e_time + '</p>';\n                    var ul_str = '<ul class=\"message\"><li>会员数<br/><span class=\"span_num\"><i class=\"js_all_person\">' + user_num + '</i>人</span></li><li>储值金额<br/><span class=\"span_num\"><i class=\"js_all_money\">' + total_pay_amt + '</i>元</span></li></ul>';\n                    var rule_str = '<ul class=\"rules\">';\n                    $(detail).each(function (i, item) {\n                        var grid_index = detail[i].grid_index;\n                        var title = detail[i].title;\n                        var user_num = detail[i].user_num;\n                        var li_str = '<li data-index=\"' + grid_index + '\"><span class=\"fr\"><i class=\"i_normal\">' + user_num + '人</i>已购买</span>' + title + '</li>';\n                        rule_str += li_str;\n                    });\n                    rule_str += '</ul>';\n                    var li_detail = '<section data-index=\"' + activity_id + '\" class=\"section_history\">' + p_str + ul_str + rule_str + '</section>';\n                    $(\".js_activityhistory_index\").append(li_detail);\n                });\n                $('.load').hide();\n                var pos_val = $('#js_pos').val() - 0;\n                if (return_data.length < 10) {\n                    if (return_data.length > 0) {\n                        scroll_more.scroll_data.nomor_show = true;\n                    } else {\n                        scroll_more.nomoredata_show();\n                        window.setTimeout(scroll_more.nomoredata_hide, 2000);\n                        scroll_more.scroll_data.nomor_show = false;\n                    }\n                    scroll_more.scroll_data.scroll_if = false;\n                } else {\n                    pos_val += 10;\n                    $('#js_pos').val(pos_val);\n                    scroll_more.scroll_data.scroll_if = true;\n                }\n                scroll_more.scroll_data.body_height = Math.floor($('body').height()).toFixed(0);\n                // console.log('AJAX:scroll_more.scroll_data.body_height==' + scroll_more.scroll_data.body_height);\n                // console.log('AJAX:scroll_if==' + scroll_more.scroll_data.scroll_if);\n                // console.log('AJAX:nomor_show==' + scroll_more.scroll_data.nomor_show);\n            }\n        });\n    });\n});"]}