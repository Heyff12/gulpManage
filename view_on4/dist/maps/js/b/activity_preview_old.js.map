{"version":3,"sources":["b/activity_preview_old.js"],"names":["click_chulist","obj","$","addClass","siblings","removeClass","require","yanzheng","close_tip","jsonp","if_menu","native","get","document","ready","on","closeToUri","uri","location","protocol","host","navToUri","cb","console","log","ret"],"mappings":"AAAA,YAGA,SAASA,eAAcC,GACnBC,EAAED,GAAKE,SAAS,aAAaC,SAAS,MAAMC,YAAY,aAE5DC,SAAS,qBAAsB,WAC3BA,SAAS,QAAS,WAAY,YAAa,QAAS,UAAW,UAAW,SAAUJ,EAAGK,EAAUC,EAAWC,EAAOC,EAASC,GACxHT,EAAE,WAWEA,EAAE,sBAAsBU,IAAI,KAAO,WAC/BV,EAAEW,UAAUC,MAAM,cAWlBZ,EAAE,mBAAmBa,GAAG,QAAS,WAE7B,GAAIC,IACAC,IAAKC,SAASC,SAAW,KAAOD,SAASE,KAAO,gCAEpDT,GAAOU,SAASL,EAAY,SAAUM,GAClCC,QAAQC,IAAIF,EAAGG,YAiL3BjB,EAAUA","file":"../../../js/b/activity_preview_old.js","sourcesContent":["'use strict';\n\n//点击储值项\nfunction click_chulist(obj) {\n    $(obj).addClass('li_choose').siblings('li').removeClass('li_choose');\n};\nrequire(['../require-config'], function () {\n    require([\"zepto\", \"yanzheng\", \"close_tip\", \"jsonp\", \"if_menu\", \"native\"], function ($, yanzheng, close_tip, jsonp, if_menu, native) {\n        $(function () {\n            //测试过期显示--不需要，进行测试\n            // var return_expired = $('#hidden').val();\n            // if (return_expired == '1') {\n            //     $('.js_content_sub').show().css('display', 'inline-block');\n            //     $('.js_content_sub_disa').hide();\n            // } else {\n            //     $('.js_content_sub').hide();\n            //     $('.js_content_sub_disa').show().css('display', 'inline-block');\n            // }\n            //储值首页----------------------------------------------------------------------------------------------------------------------------------------------------\n            $('.js_recharge_index').get(0) && ~function () {\n                $(document).ready(function () {\n                    //获取信息todo-show\n                    //get_activity_pre();\n                    //获取储值规则\n                    //get_rule_detail();\n                });\n                //点击确定进入home页\n                // $('.js_content_sub').on('click', function() {\n                //     var home_url = $(this).attr('data-url');\n                //     location.href = home_url;\n                // });\n                $('.js_content_sub').on('click', function () {\n                    //todo: close all gotourl 首页\n                    var closeToUri = {\n                        uri: location.protocol + '//' + location.host + '/prepaid/v1/page/b/index.html'\n                    };\n                    native.navToUri(closeToUri, function (cb) {\n                        console.log(cb.ret);\n                    });\n                });\n                //选择储值项——————--不需要，进行测试\n                // $(document).on('click', '.js_rechage_ul li', function() {\n                //     $(this).addClass('li_choose').siblings('li').removeClass('li_choose');\n                // });\n            }();\n            //获取储值规则\n            function get_rule_detail() {\n                $.ajax({\n                    url: 'http://192.168.0.7:7013/prepaid/v1/api/c/rulexplain',\n                    type: 'GET',\n                    dataType: 'jsonp',\n                    //jsonp:\"callback\",\n                    //jsonpCallback:\"success_jsonpCallback\",\n                    data: {\n                        'c': yanzheng.get_hash('c'),\n                        'h': yanzheng.get_hash('h')\n                    },\n                    beforeSend: function beforeSend() {\n                        $('#loading').show();\n                    },\n                    success: function success(data) {\n                        for (var i in data) {\n                            alert(i + \":\" + data[i]); //循环输出a:1,b:2,etc.  \n                        }\n                        if (data.respcd != '0000') {\n                            $('#alert_alert').show();\n                            $('.zheceng1').show();\n                            if (!data['respmsg']) {\n                                $('#alert_alert .alert_con_br').html(data['resperr']);\n                            } else {\n                                $('#alert_alert .alert_con_br').html(data['respmsg']);\n                            }\n                        } else {\n                            var return_data = data.data;\n                            var return_data_l = return_data.length;\n                            for (var i = 0; i < return_data_l; i++) {\n                                var li_detail = '<li><span>' + return_data[i] + '</span></li>';\n                                $(\".js_note_ul_detail\").append(li_detail);\n                            }\n                            $('.zheceng1').hide();\n                        }\n                    },\n                    error: function error(data) {\n                        $('#alert_alert').show();\n                        $('.zheceng1').show();\n                        //$('.alert_con .alert_con_br').html('XMLHttpRequest.readyState:'+XMLHttpRequest.readyState+',XMLHttpRequest.status:'+XMLHttpRequest.status+',textStatus:'+textStatus+'!');\n                        $('#alert_alert .alert_con_br').html('网络超时!');\n                    },\n                    complete: function complete() {\n                        $('#loading').hide();\n                        //$('.zheceng').hide();\n                    }\n                });\n                // $.jsonp({\n                //     url: 'http://192.168.0.7:7013/prepaid/v1/api/c/rulexplain',\n                //     data: { 'c': yanzheng.get_hash('c'),\n                //         'h': yanzheng.get_hash('h'), },\n                //     callbackParameter: \"callback\",\n                //     timeout: 3000,\n                //     dataFilter: function(json) {\n                //         console.log(\"jsonp.filter:\" + json.name);\n                //         json.name = \"测试123435\";\n                //         return json;\n                //     },\n                //     success: function(json, textStatus, xOptions) {\n                //         console.log(\"jsonp.success:\" + json.name);\n                //     },\n                //     error: function(xOptions, textStatus) {\n                //         console.log(\"jsonp.error:\" + textStatus + \", rel=\" + xOptions.data.rel);\n                //     }\n                // });\n            }\n            //获取信息\n            function get_activity_pre() {\n                $.ajax({\n                    url: 'http://192.168.0.7:7013/prepaid/v1/api/b/cur_activity',\n                    type: 'GET',\n                    dataType: 'jsonp',\n                    //jsonp:\"callback\",\n                    //jsonpCallback:\"success_jsonpCallback\",\n                    data: {\n                        // 'c': yanzheng.get_hash('c'),\n                        // 'h': yanzheng.get_hash('h'),\n                    },\n                    beforeSend: function beforeSend(request) {\n                        $('#loading').show();\n                        $('.zheceng').show();\n                        //request.setRequestHeader(\"sessionid\", \"feff17fc-c223-4a05-9ce8-0c17418c0603\");\n                    },\n                    success: function success(data) {\n                        if (data.respcd != '0000') {\n                            $('#alert_alert').show();\n                            $('.zheceng').show();\n                            if (!data['respmsg']) {\n                                $('#alert_alert .alert_con_br').html(data['resperr']);\n                            } else {\n                                $('#alert_alert .alert_con_br').html(data['respmsg']);\n                            }\n                        } else {\n                            //获取活动id\n                            var activity_id = data.data.info.activity_id;\n                            var home_url = 'http://' + location.host + '/prepaid/v1/page/b/index.html?activity_id=' + activity_id;\n                            $('.js_content_sub').attr('data-url', home_url);\n                            var return_data = data.data.rules;\n                            //获取规则当中储值可用的规则\n                            var return_data_right = [];\n                            $(return_data).each(function (i, item) {\n                                var tx_fee = return_data[i].present_amt / 100;\n                                var tx_txamt = return_data[i].pay_amt / 100;\n                                var tx_fee1 = tx_fee.toString().indexOf('.');\n                                var tx_txamt1 = tx_txamt.toString().indexOf('.');\n                                if (tx_fee >= 1 && tx_txamt >= 1 && tx_fee1 == '-1' && tx_txamt1 == '-1') {\n                                    return_data_right.push(item);\n                                }\n                            });\n                            var data_length = return_data_right.length;\n                            if (data_length == '0') {\n                                $('.js_content_sub').hide();\n                                $('.js_content_sub_disa').show().css('display', 'inline-block');\n                                $('.zheceng').hide();\n                                return false;\n                            } else {\n                                $('.js_content_sub').show().css('display', 'inline-block');\n                                $('.js_content_sub_disa').hide();\n                            }\n                            $(return_data_right).each(function (i, item) {\n                                var tx_fee = (return_data_right[i].present_amt / 100).toFixed(0);\n                                var tx_txamt = (return_data_right[i].pay_amt / 100).toFixed(0);\n                                var tx_index = return_data_right[i].grid_index;\n                                var li_detail;\n                                if (data_length == '1') {\n                                    li_detail = '<li class=\"li_one\" onclick=\"click_chulist(this)\" data-index=\"' + tx_index + '\"><p class=\"font_17\">储值<span class=\"js_rechar_num\">' + tx_txamt + '</span>元</p><p>送<span class=\"js_rechar_sendnum\">' + tx_fee + '</span>元</p><span class=\"choose\"><i class=\"choose_i\"></i></span></li>';\n                                } else if (data_length == '2') {\n                                    li_detail = '<li class=\"li_two\" onclick=\"click_chulist(this)\" data-index=\"' + tx_index + '\"><p class=\"font_17\">储值<span class=\"js_rechar_num\">' + tx_txamt + '</span>元</p><p>送<span class=\"js_rechar_sendnum\">' + tx_fee + '</span>元</p><span class=\"choose\"><i class=\"choose_i\"></i></span></li>';\n                                } else {\n                                    li_detail = '<li onclick=\"click_chulist(this)\" data-index=\"' + tx_index + '\"><p class=\"font_17\">储值<span class=\"js_rechar_num\">' + tx_txamt + '</span>元</p><p>送<span class=\"js_rechar_sendnum\">' + tx_fee + '</span>元</p><span class=\"choose\"><i class=\"choose_i\"></i></span></li>';\n                                }\n                                $(\".js_rechage_ul\").append(li_detail);\n                            });\n                            $(\".js_rechage_ul li\").eq(0).addClass('li_choose');\n                            //获取活动信息--该信息只有备注，取消不用\n                            // var return_data_desc = data.data.info.desc;\n                            // var return_data_l = return_data_desc.length;\n                            // for (var i = 0; i < return_data_l; i++) {\n                            //     var li_detail = '<li><span>' + return_data[i] + '</span></li>';\n                            //     $(\".js_note_ul_detail\").append(li_detail);\n                            // }\n                            //验证是否过期\n                            var return_expired = data.data.info.active;\n                            if (return_expired == '1') {\n                                $('.js_content_sub').show().css('display', 'inline-block');\n                                $('.js_content_sub_disa').hide();\n                            } else {\n                                //过期无效\n                                $('.js_content_sub').hide();\n                                $('.js_content_sub_disa').show().css('display', 'inline-block');\n                                $('.zheceng').hide();\n                                return false;\n                            }\n                            $('.zheceng').hide();\n                        }\n                    },\n                    error: function error() {\n                        $('#alert_alert').show();\n                        $('.zheceng').show();\n                        $('.alert_con .alert_con_br').html('XMLHttpRequest.readyState:' + XMLHttpRequest.readyState + ',XMLHttpRequest.status:' + XMLHttpRequest.status + ',textStatus:' + textStatus + '!');\n                        //$('#alert_alert .alert_con_br').html('网络超时!');\n                    },\n                    complete: function complete() {\n                        $('#loading').hide();\n                    }\n                });\n            }\n            //关闭弹框\n            close_tip.close_tip();\n        });\n    });\n});"]}