{"version":3,"sources":["recharge/recharge_r.js"],"names":["require","$","yanzheng","ajaxps","date","wxjsbridge","hide_menu","get_rule_detail","return_expired","val","show","hide","get","document","ready","on","this","addClass","siblings","removeClass","alert_top","first","birth_test","tel_test","china_test","bor_red_num","length"],"mappings":"AAAA,YAEAA,UAAS,qBAAsB,WAC3BA,SAAS,SAAU,WAAY,SAAU,OAAQ,cAAe,SAAUC,EAAGC,EAAUC,EAAQC,EAAMC,GACjGJ,EAAE,WAEEI,EAAWC,YACXH,EAAOI,iBAEP,IAAIC,GAAiBP,EAAE,WAAWQ,KACZ,MAAlBD,GACAP,EAAE,eAAeS,OACjBT,EAAE,eAAeU,SAEjBV,EAAE,eAAeU,OACjBV,EAAE,eAAeS,QAGrBT,EAAE,sBAAsBW,IAAI,KAAO,WAC/BX,EAAEY,UAAUC,MAAM,cAQlBV,EAAKA,OAKLH,EAAEY,UAAUE,GAAG,QAAS,oBAAqB,WACzCd,EAAEe,MAAMC,SAAS,aAAaC,SAAS,MAAMC,YAAY,eAG7DlB,EAAE,mBAAmBc,GAAG,QAAS,WAC7Bd,EAAE,kBAAkBS,OACpBR,EAASkB,UAAU,kBACnBnB,EAAE,YAAYS,SAGlBT,EAAE,qBAAqBc,GAAG,QAAS,WAC/B,GAAIM,GAAQpB,EAAE,oBAAoBQ,KACvBR,GAAE,oBAAoBQ,MACvBR,EAAE,mBAAmBQ,MACnBR,EAAE,qBAAqBQ,KACtB,MAATY,EACAnB,EAASoB,WAAW,qBAAqB,EAAI,KAE7CpB,EAASqB,SAAS,mBAClBrB,EAASsB,WAAW,mBAAoB,EAAG,GAC3CtB,EAASoB,WAAW,qBAAqB,EAAI,IAEjD,IAAIG,GAAcxB,EAAE,eAAeyB,MACnC,IAAID,EAAc,EACd,OAAO,OAkQnBxB,EAAE,uBAAuBc,GAAG,QAAS,WACjCd,EAAE,cAAcU,OAEhBV,EAAE,YAAYU,OACdV,EAAE,aAAaU,OACfV,EAAE,aAAaU","file":"../../../js/recharge/recharge_r.js","sourcesContent":["\"use strict\";\n\nrequire(['../require-config'], function () {\n    require([\"jquery\", \"yanzheng\", \"ajaxps\", \"date\", \"wxjsbridge\"], function ($, yanzheng, ajaxps, date, wxjsbridge) {\n        $(function () {\n            //隐藏微信菜单           \n            wxjsbridge.hide_menu();\n            ajaxps.get_rule_detail();\n            //测试过期显示--不需要，进攻测试\n            var return_expired = $('#hidden').val();\n            if (return_expired == '1') {\n                $('.js_li_none').show();\n                $('.js_li_show').hide();\n            } else {\n                $('.js_li_none').hide();\n                $('.js_li_show').show();\n            }\n            //储值首页----------------------------------------------------------------------------------------------------------------------------------------------------\n            $('.js_recharge_index').get(0) && ~function () {\n                $(document).ready(function () {\n                    //获取储值列表todo-show\n                    //get_rechargeli();\n                    //获取储值规则-show\n                    //get_rule_detail();\n                    //获取当前用户个人信息-show\n                    //get_message();\n                });\n                date.date();\n                //选择储值项——————add_new\n                // $('.js_rechage_ul li').live('click', function() {\n                //     $(this).addClass('li_choose').siblings('li').removeClass('li_choose');\n                // });\n                $(document).on('click', '.js_rechage_ul li', function () {\n                    $(this).addClass('li_choose').siblings('li').removeClass('li_choose');\n                });\n                //点击购买弹出填写信息——————add_new\n                $('.js_content_sub').on('click', function () {\n                    $('#alert_message').show();\n                    yanzheng.alert_top('#alert_message');\n                    $('.zheceng').show();\n                });\n                //点击填写信息确定按钮——————add_new\n                $('.js_alert_message').on('click', function () {\n                    var first = $('.js_hidden_first').val();\n                    var name = $('.js_message_name').val();\n                    var tel = $('.js_message_tel').val();\n                    var birth = $('.js_message_birth').val();\n                    if (first == '1') {\n                        yanzheng.birth_test('.js_message_birth', -1, 20);\n                    } else {\n                        yanzheng.tel_test('.js_message_tel');\n                        yanzheng.china_test('.js_message_name', 1, 4);\n                        yanzheng.birth_test('.js_message_birth', -1, 20);\n                    }\n                    var bor_red_num = $('.border_red').length;\n                    if (bor_red_num > 0) {\n                        return false;\n                    }\n                    //提交充值\n                    //get_rechargesub(name,tel,birth);\n                });\n            }();\n            //获取储值规则\n            function get_rule_detail() {\n                $.ajax({\n                    url: '/prepaid/v1/api/c/rulexplain',\n                    type: 'GET',\n                    dataType: 'json',\n                    data: {\n                        'c': get_hash('c'),\n                        'h': get_hash('h')\n                    },\n                    beforeSend: function beforeSend() {\n                        $('#loading').show();\n                        $('.zheceng1').show();\n                    },\n                    success: function success(data) {\n                        if (data.respcd != '0000') {\n                            $('#alert_alert').show();\n                            $('.zheceng1').show();\n                            if (!data['respmsg']) {\n                                $('#alert_alert .alert_con_br').html(data['resperr']);\n                            } else {\n                                $('#alert_alert .alert_con_br').html(data['respmsg']);\n                            }\n                        } else {\n                            var return_data = data.data;\n                            var return_data_l = return_data.length;\n                            for (var i = 0; i < return_data_l; i++) {\n                                var li_detail = '<li><span>' + return_data[i] + '</span></li>';\n                                $(\".js_note_ul_detail\").append(li_detail);\n                            }\n                            $('.zheceng1').hide();\n                        }\n                    },\n                    error: function error(data) {\n                        $('#alert_alert').show();\n                        $('.zheceng1').show();\n                        //$('.alert_con .alert_con_br').html('XMLHttpRequest.readyState:'+XMLHttpRequest.readyState+',XMLHttpRequest.status:'+XMLHttpRequest.status+',textStatus:'+textStatus+'!');\n                        $('#alert_alert .alert_con_br').html('网络超时!');\n                    },\n                    complete: function complete() {\n                        $('#loading').hide();\n                        //$('.zheceng').hide();\n                    }\n                });\n            }\n            //获取个人信息-----add_new\n            function get_message() {\n                $('.js_dl_message input').val('');\n                $.ajax({\n                    url: '/prepaid/v1/api/c/bind',\n                    type: 'GET',\n                    dataType: 'json',\n                    data: {\n                        'c': get_hash('c'),\n                        'h': get_hash('h')\n                    },\n                    beforeSend: function beforeSend() {\n                        $('#loading').show();\n                        $('.zheceng2').show();\n                    },\n                    success: function success(data) {\n                        if (data.respcd != '0000') {\n                            $('#alert_alert').show();\n                            $('.zheceng2').show();\n                            if (!data['respmsg']) {\n                                $('#alert_alert .alert_con_br').html(data['resperr']);\n                            } else {\n                                $('#alert_alert .alert_con_br').html(data['respmsg']);\n                            }\n                        } else {\n                            var return_data = data.data;\n                            var return_binded = return_data.binded;\n                            var return_name = return_data.name;\n                            var return_mobile = return_data.mobile;\n                            var return_birth = return_data.birthday;\n                            $('.js_hidden_first').val(return_binded);\n                            $('.js_message_name').val(return_name);\n                            $('.js_message_tel').val(return_mobile);\n                            $('.js_message_birth').val(return_birth);\n                            if (return_binded == '1') {\n                                $('.js_dl_message input.js_input').attr('readonly', 'readonly').addClass('grey');\n                                if (return_birth.length > 0) {\n                                    $('.js_message_birth').attr('disabled', 'disabled').addClass('grey');\n                                } else {\n                                    $('.js_message_birth').removeAttr('disabled').removeClass('grey');\n                                }\n                            } else {\n                                $('.js_dl_message input.js_input').removeAttr('readonly').removeClass('grey');\n                                $('.js_message_birth').removeAttr('disabled').removeClass('grey');\n                            }\n                            $('.zheceng2').hide();\n                        }\n                    },\n                    error: function error(data) {\n                        $('#alert_alert').show();\n                        $('.zheceng2').show();\n                        //$('.alert_con .alert_con_br').html('XMLHttpRequest.readyState:'+XMLHttpRequest.readyState+',XMLHttpRequest.status:'+XMLHttpRequest.status+',textStatus:'+textStatus+'!');\n                        $('#alert_alert .alert_con_br').html('网络超时!');\n                    },\n                    complete: function complete() {\n                        $('#loading').hide();\n                        //$('.zheceng').hide();\n                    }\n                });\n            }\n            //点击购买\n            function get_rechargesub(name, tel, birth) {\n                $.ajax({\n                    url: '/prepaid/v1/api/c/recharge',\n                    type: 'POST',\n                    dataType: 'json',\n                    data: {\n                        'c': get_hash('c'),\n                        'h': get_hash('h'),\n                        'o': get_hash('o'),\n                        'grid_index': $('.js_rechage_ul li.li_choose').attr('data-index'),\n                        'name': name,\n                        'mobile': tel,\n                        'birthday': birth\n                    },\n                    beforeSend: function beforeSend() {\n                        // $('#loading').show();\n                        // $('.zheceng').show();\n                        $('.js_alert_message').hide();\n                        $('.js_load_message').show().css('display', 'inline-block');\n                        // $('.js_alert_message').attr('disabled', 'disabled').addClass('disa');\n                        // $('.js_alert_message').find('i.js_i_sure').hide();\n                        // $('.js_alert_message').find('i.js_i_load').show().css('display','inline-block');\n                    },\n                    success: function success(data) {\n                        if (data.respcd != '0000') {\n                            $('.js_alert_message').show().css('display', 'inline-block');\n                            $('.js_load_message').hide();\n                            $('#alert_message').hide();\n                            $('#passerror_alert').show();\n                            $('.zheceng').show();\n                            if (!data['respmsg']) {\n                                $('#passerror_alert .alert_con_br').html(data['resperr']);\n                            } else {\n                                $('#passerror_alert .alert_con_br').html(data['respmsg']);\n                            }\n                        } else {\n                            //pay_now();\n                            //$('.zheceng').hide();\n                            window.location.href = data.data.url;\n                        }\n                    },\n                    error: function error(data) {\n                        $('.js_alert_message').show().css('display', 'inline-block');\n                        $('.js_load_message').hide();\n                        $('#alert_message').hide();\n                        $('#passerror_alert').show();\n                        $('.zheceng').show();\n                        //$('.alert_con .alert_con_br').html('XMLHttpRequest.readyState:'+XMLHttpRequest.readyState+',XMLHttpRequest.status:'+XMLHttpRequest.status+',textStatus:'+textStatus+'!');\n                        $('#passerror_alert .alert_con_br').html('网络超时!');\n                    },\n                    complete: function complete() {\n                        // $('#loading').hide();\n                        //$('.zheceng').hide();\n                        // $('.js_alert_message').removeAttr('disabled').removeClass('disa');\n                        // $('.js_alert_message').find('i.js_i_sure').show();\n                        // $('.js_alert_message').find('i.js_i_load').hide();\n                    }\n                });\n            }\n            //获取储值列表\n            function get_rechargeli() {\n                $.ajax({\n                    url: '/prepaid/v1/api/c/recharge/rules',\n                    type: 'GET',\n                    dataType: 'json',\n                    data: {\n                        'c': get_hash('c'),\n                        'h': get_hash('h')\n                    },\n                    beforeSend: function beforeSend() {\n                        $('#loading').show();\n                        $('.zheceng').show();\n                    },\n                    success: function success(data) {\n                        if (data.respcd != '0000') {\n                            $('#alert_alert').show();\n                            $('.zheceng').show();\n                            if (!data['respmsg']) {\n                                $('#alert_alert .alert_con_br').html(data['resperr']);\n                            } else {\n                                $('#alert_alert .alert_con_br').html(data['respmsg']);\n                            }\n                        } else {\n                            //验证是否过期\n                            var return_expired = data.data.expired;\n                            if (return_expired == '1') {\n                                $('.js_li_none').show();\n                                $('.js_li_show').hide();\n                                $('.zheceng').hide();\n                                return false;\n                            } else {\n                                $('.js_li_none').hide();\n                                $('.js_li_show').show();\n                            }\n                            var return_data = data.data.rules;\n                            //获取规则当中储值可用的规则\n                            var return_data_right = [];\n                            $(return_data).each(function (i, item) {\n                                var tx_fee = (return_data[i].present_amt / 100).toFixed(0);\n                                var tx_txamt = (return_data[i].pay_amt / 100).toFixed(0);\n                                if (tx_fee >= 1 && tx_txamt >= 1) {\n                                    return_data_right.push(item);\n                                }\n                            });\n                            //console.log(return_data_right);\n                            var data_length = return_data_right.length;\n                            if (data_length == '0') {\n                                $('.js_content_sub_disa').show();\n                                $('.js_content_sub').hide();\n                                $('.zheceng').hide();\n                                return false;\n                            } else {\n                                $('.js_content_sub_disa').hide();\n                                $('.js_content_sub').show();\n                            }\n                            $(return_data_right).each(function (i, item) {\n                                var tx_fee = (return_data_right[i].present_amt / 100).toFixed(0);\n                                var tx_txamt = (return_data_right[i].pay_amt / 100).toFixed(0);\n                                var tx_index = return_data_right[i].grid_index;\n                                var li_detail;\n                                if (data_length == '1') {\n                                    li_detail = '<li class=\"li_one\" onclick=\"click_chulist(this)\" data-index=\"' + tx_index + '\"><p class=\"font_17\">储值<span class=\"js_rechar_num\">' + tx_txamt + '</span>元</p><p>送<span class=\"js_rechar_sendnum\">' + tx_fee + '</span>元</p><span class=\"choose\"><i class=\"choose_i\"></i></span></li>';\n                                } else if (data_length == '2') {\n                                    li_detail = '<li class=\"li_two\" onclick=\"click_chulist(this)\" data-index=\"' + tx_index + '\"><p class=\"font_17\">储值<span class=\"js_rechar_num\">' + tx_txamt + '</span>元</p><p>送<span class=\"js_rechar_sendnum\">' + tx_fee + '</span>元</p><span class=\"choose\"><i class=\"choose_i\"></i></span></li>';\n                                } else {\n                                    li_detail = '<li onclick=\"click_chulist(this)\" data-index=\"' + tx_index + '\"><p class=\"font_17\">储值<span class=\"js_rechar_num\">' + tx_txamt + '</span>元</p><p>送<span class=\"js_rechar_sendnum\">' + tx_fee + '</span>元</p><span class=\"choose\"><i class=\"choose_i\"></i></span></li>';\n                                }\n                                $(\".js_rechage_ul\").append(li_detail);\n                            });\n                            $(\".js_rechage_ul li\").eq(0).addClass('li_choose');\n                            $('.zheceng').hide();\n                        }\n                    },\n                    error: function error(data) {\n                        $('#alert_alert').show();\n                        $('.zheceng').show();\n                        //$('.alert_con .alert_con_br').html('XMLHttpRequest.readyState:'+XMLHttpRequest.readyState+',XMLHttpRequest.status:'+XMLHttpRequest.status+',textStatus:'+textStatus+'!');\n                        $('#alert_alert .alert_con_br').html('网络超时!');\n                    },\n                    complete: function complete() {\n                        $('#loading').hide();\n                        //$('.zheceng').hide();\n                    }\n                });\n            }\n            //关闭弹框\n            $('.js_alert_con_close').on('click', function () {\n                $('.alert_con').hide();\n                // $('.alert_con .alert_con_br').html();\n                $('.zheceng').hide();\n                $('.zheceng1').hide();\n                $('.zheceng2').hide();\n            });\n        });\n    });\n});"]}